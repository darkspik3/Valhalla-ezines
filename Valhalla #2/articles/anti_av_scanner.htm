<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 14">
<meta name=Originator content="Microsoft Word 14">
<link rel=File-List
href="Creating%20an%20Anti-AV%20scanner%20Article_files/filelist.xml">
<link rel=Preview
href="Creating%20an%20Anti-AV%20scanner%20Article_files/preview.wmf">
<link rel=Edit-Time-Data
href="Creating%20an%20Anti-AV%20scanner%20Article_files/editdata.mso">
<!--[if !mso]>
<style>
v\:* {behavior:url(#default#VML);}
o\:* {behavior:url(#default#VML);}
w\:* {behavior:url(#default#VML);}
.shape {behavior:url(#default#VML);}
</style>
<![endif]-->
<title>Creating an Anti-AV scanner</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>Peter Kleissner</o:Author>
  <o:Template>Stoned.dotx</o:Template>
  <o:LastAuthor>Peter Kleissner</o:LastAuthor>
  <o:Revision>5</o:Revision>
  <o:TotalTime>10709</o:TotalTime>
  <o:LastPrinted>2012-03-08T20:49:00Z</o:LastPrinted>
  <o:Created>2012-03-08T20:58:00Z</o:Created>
  <o:LastSaved>2012-03-08T21:01:00Z</o:LastSaved>
  <o:Pages>10</o:Pages>
  <o:Words>3001</o:Words>
  <o:Characters>17111</o:Characters>
  <o:Company>Genco</o:Company>
  <o:Lines>142</o:Lines>
  <o:Paragraphs>40</o:Paragraphs>
  <o:CharactersWithSpaces>20072</o:CharactersWithSpaces>
  <o:Version>14.00</o:Version>
 </o:DocumentProperties>
 <o:OfficeDocumentSettings>
  <o:RelyOnVML/>
  <o:AllowPNG/>
 </o:OfficeDocumentSettings>
</xml><![endif]-->
<link rel=dataStoreItem
href="Creating%20an%20Anti-AV%20scanner%20Article_files/item0017.xml"
target="Creating%20an%20Anti-AV%20scanner%20Article_files/props018.xml">
<link rel=themeData
href="Creating%20an%20Anti-AV%20scanner%20Article_files/themedata.thmx">
<link rel=colorSchemeMapping
href="Creating%20an%20Anti-AV%20scanner%20Article_files/colorschememapping.xml">
<!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:SpellingState>Clean</w:SpellingState>
  <w:GrammarState>Clean</w:GrammarState>
  <w:TrackMoves>false</w:TrackMoves>
  <w:TrackFormatting/>
  <w:HyphenationZone>21</w:HyphenationZone>
  <w:PunctuationKerning/>
  <w:DrawingGridHorizontalSpacing>5.5 pt</w:DrawingGridHorizontalSpacing>
  <w:DisplayHorizontalDrawingGridEvery>2</w:DisplayHorizontalDrawingGridEvery>
  <w:ValidateAgainstSchemas/>
  <w:SaveIfXMLInvalid>false</w:SaveIfXMLInvalid>
  <w:IgnoreMixedContent>false</w:IgnoreMixedContent>
  <w:AlwaysShowPlaceholderText>false</w:AlwaysShowPlaceholderText>
  <w:DoNotPromoteQF/>
  <w:LidThemeOther>DE-AT</w:LidThemeOther>
  <w:LidThemeAsian>X-NONE</w:LidThemeAsian>
  <w:LidThemeComplexScript>X-NONE</w:LidThemeComplexScript>
  <w:Compatibility>
   <w:BreakWrappedTables/>
   <w:SnapToGridInCell/>
   <w:WrapTextWithPunct/>
   <w:UseAsianBreakRules/>
   <w:DontGrowAutofit/>
   <w:SplitPgBreakAndParaMark/>
   <w:EnableOpenTypeKerning/>
   <w:DontFlipMirrorIndents/>
   <w:OverrideTableStyleHps/>
   <w:UseFELayout/>
  </w:Compatibility>
  <w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel>
  <m:mathPr>
   <m:mathFont m:val="Cambria Math"/>
   <m:brkBin m:val="before"/>
   <m:brkBinSub m:val="&#45;-"/>
   <m:smallFrac m:val="off"/>
   <m:dispDef/>
   <m:lMargin m:val="0"/>
   <m:rMargin m:val="0"/>
   <m:defJc m:val="centerGroup"/>
   <m:wrapIndent m:val="1440"/>
   <m:intLim m:val="subSup"/>
   <m:naryLim m:val="undOvr"/>
  </m:mathPr></w:WordDocument>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:LatentStyles DefLockedState="false" DefUnhideWhenUsed="true"
  DefSemiHidden="true" DefQFormat="false" DefPriority="99"
  LatentStyleCount="267">
  <w:LsdException Locked="false" Priority="0" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Normal"/>
  <w:LsdException Locked="false" Priority="9" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="heading 1"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 2"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 3"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 4"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 5"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 6"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 7"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 8"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 9"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 1"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 2"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 3"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 4"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 5"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 6"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 7"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 8"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 9"/>
  <w:LsdException Locked="false" Priority="35" QFormat="true" Name="caption"/>
  <w:LsdException Locked="false" Priority="10" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Title"/>
  <w:LsdException Locked="false" Priority="1" Name="Default Paragraph Font"/>
  <w:LsdException Locked="false" Priority="11" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Subtitle"/>
  <w:LsdException Locked="false" Priority="22" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Strong"/>
  <w:LsdException Locked="false" Priority="20" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Emphasis"/>
  <w:LsdException Locked="false" Priority="59" SemiHidden="false"
   UnhideWhenUsed="false" Name="Table Grid"/>
  <w:LsdException Locked="false" UnhideWhenUsed="false" Name="Placeholder Text"/>
  <w:LsdException Locked="false" Priority="1" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="No Spacing"/>
  <w:LsdException Locked="false" Priority="60" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Shading"/>
  <w:LsdException Locked="false" Priority="61" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light List"/>
  <w:LsdException Locked="false" Priority="62" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Grid"/>
  <w:LsdException Locked="false" Priority="63" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 1"/>
  <w:LsdException Locked="false" Priority="64" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 2"/>
  <w:LsdException Locked="false" Priority="65" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 1"/>
  <w:LsdException Locked="false" Priority="66" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 2"/>
  <w:LsdException Locked="false" Priority="67" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 1"/>
  <w:LsdException Locked="false" Priority="68" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 2"/>
  <w:LsdException Locked="false" Priority="69" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 3"/>
  <w:LsdException Locked="false" Priority="70" SemiHidden="false"
   UnhideWhenUsed="false" Name="Dark List"/>
  <w:LsdException Locked="false" Priority="71" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Shading"/>
  <w:LsdException Locked="false" Priority="72" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful List"/>
  <w:LsdException Locked="false" Priority="73" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Grid"/>
  <w:LsdException Locked="false" Priority="60" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Shading Accent 1"/>
  <w:LsdException Locked="false" Priority="61" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light List Accent 1"/>
  <w:LsdException Locked="false" Priority="62" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Grid Accent 1"/>
  <w:LsdException Locked="false" Priority="63" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 1 Accent 1"/>
  <w:LsdException Locked="false" Priority="64" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="65" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 1 Accent 1"/>
  <w:LsdException Locked="false" UnhideWhenUsed="false" Name="Revision"/>
  <w:LsdException Locked="false" Priority="34" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="List Paragraph"/>
  <w:LsdException Locked="false" Priority="29" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Quote"/>
  <w:LsdException Locked="false" Priority="30" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Intense Quote"/>
  <w:LsdException Locked="false" Priority="66" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="67" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 1 Accent 1"/>
  <w:LsdException Locked="false" Priority="68" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="69" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 3 Accent 1"/>
  <w:LsdException Locked="false" Priority="70" SemiHidden="false"
   UnhideWhenUsed="false" Name="Dark List Accent 1"/>
  <w:LsdException Locked="false" Priority="71" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Shading Accent 1"/>
  <w:LsdException Locked="false" Priority="72" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful List Accent 1"/>
  <w:LsdException Locked="false" Priority="73" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Grid Accent 1"/>
  <w:LsdException Locked="false" Priority="60" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Shading Accent 2"/>
  <w:LsdException Locked="false" Priority="61" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light List Accent 2"/>
  <w:LsdException Locked="false" Priority="62" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Grid Accent 2"/>
  <w:LsdException Locked="false" Priority="63" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 1 Accent 2"/>
  <w:LsdException Locked="false" Priority="64" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="65" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 1 Accent 2"/>
  <w:LsdException Locked="false" Priority="66" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="67" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 1 Accent 2"/>
  <w:LsdException Locked="false" Priority="68" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="69" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 3 Accent 2"/>
  <w:LsdException Locked="false" Priority="70" SemiHidden="false"
   UnhideWhenUsed="false" Name="Dark List Accent 2"/>
  <w:LsdException Locked="false" Priority="71" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Shading Accent 2"/>
  <w:LsdException Locked="false" Priority="72" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful List Accent 2"/>
  <w:LsdException Locked="false" Priority="73" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Grid Accent 2"/>
  <w:LsdException Locked="false" Priority="60" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Shading Accent 3"/>
  <w:LsdException Locked="false" Priority="61" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light List Accent 3"/>
  <w:LsdException Locked="false" Priority="62" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Grid Accent 3"/>
  <w:LsdException Locked="false" Priority="63" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 1 Accent 3"/>
  <w:LsdException Locked="false" Priority="64" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="65" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 1 Accent 3"/>
  <w:LsdException Locked="false" Priority="66" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="67" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 1 Accent 3"/>
  <w:LsdException Locked="false" Priority="68" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="69" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 3 Accent 3"/>
  <w:LsdException Locked="false" Priority="70" SemiHidden="false"
   UnhideWhenUsed="false" Name="Dark List Accent 3"/>
  <w:LsdException Locked="false" Priority="71" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Shading Accent 3"/>
  <w:LsdException Locked="false" Priority="72" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful List Accent 3"/>
  <w:LsdException Locked="false" Priority="73" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Grid Accent 3"/>
  <w:LsdException Locked="false" Priority="60" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Shading Accent 4"/>
  <w:LsdException Locked="false" Priority="61" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light List Accent 4"/>
  <w:LsdException Locked="false" Priority="62" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Grid Accent 4"/>
  <w:LsdException Locked="false" Priority="63" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 1 Accent 4"/>
  <w:LsdException Locked="false" Priority="64" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="65" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 1 Accent 4"/>
  <w:LsdException Locked="false" Priority="66" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="67" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 1 Accent 4"/>
  <w:LsdException Locked="false" Priority="68" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="69" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 3 Accent 4"/>
  <w:LsdException Locked="false" Priority="70" SemiHidden="false"
   UnhideWhenUsed="false" Name="Dark List Accent 4"/>
  <w:LsdException Locked="false" Priority="71" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Shading Accent 4"/>
  <w:LsdException Locked="false" Priority="72" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful List Accent 4"/>
  <w:LsdException Locked="false" Priority="73" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Grid Accent 4"/>
  <w:LsdException Locked="false" Priority="60" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Shading Accent 5"/>
  <w:LsdException Locked="false" Priority="61" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light List Accent 5"/>
  <w:LsdException Locked="false" Priority="62" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Grid Accent 5"/>
  <w:LsdException Locked="false" Priority="63" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 1 Accent 5"/>
  <w:LsdException Locked="false" Priority="64" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="65" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 1 Accent 5"/>
  <w:LsdException Locked="false" Priority="66" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="67" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 1 Accent 5"/>
  <w:LsdException Locked="false" Priority="68" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="69" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 3 Accent 5"/>
  <w:LsdException Locked="false" Priority="70" SemiHidden="false"
   UnhideWhenUsed="false" Name="Dark List Accent 5"/>
  <w:LsdException Locked="false" Priority="71" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Shading Accent 5"/>
  <w:LsdException Locked="false" Priority="72" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful List Accent 5"/>
  <w:LsdException Locked="false" Priority="73" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Grid Accent 5"/>
  <w:LsdException Locked="false" Priority="60" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Shading Accent 6"/>
  <w:LsdException Locked="false" Priority="61" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light List Accent 6"/>
  <w:LsdException Locked="false" Priority="62" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Grid Accent 6"/>
  <w:LsdException Locked="false" Priority="63" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 1 Accent 6"/>
  <w:LsdException Locked="false" Priority="64" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="65" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 1 Accent 6"/>
  <w:LsdException Locked="false" Priority="66" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="67" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 1 Accent 6"/>
  <w:LsdException Locked="false" Priority="68" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="69" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 3 Accent 6"/>
  <w:LsdException Locked="false" Priority="70" SemiHidden="false"
   UnhideWhenUsed="false" Name="Dark List Accent 6"/>
  <w:LsdException Locked="false" Priority="71" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Shading Accent 6"/>
  <w:LsdException Locked="false" Priority="72" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful List Accent 6"/>
  <w:LsdException Locked="false" Priority="73" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Grid Accent 6"/>
  <w:LsdException Locked="false" Priority="19" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Subtle Emphasis"/>
  <w:LsdException Locked="false" Priority="21" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Intense Emphasis"/>
  <w:LsdException Locked="false" Priority="31" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Subtle Reference"/>
  <w:LsdException Locked="false" Priority="32" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Intense Reference"/>
  <w:LsdException Locked="false" Priority="33" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Book Title"/>
  <w:LsdException Locked="false" Priority="37" Name="Bibliography"/>
  <w:LsdException Locked="false" Priority="39" QFormat="true" Name="TOC Heading"/>
 </w:LatentStyles>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;
	mso-font-charset:2;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;
	mso-font-charset:1;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:0 0 0 0 0 0;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:-520092929 1073786111 9 0 415 0;}
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:-520081665 -1073717157 41 0 66047 0;}
@font-face
	{font-family:Verdana;
	panose-1:2 11 6 4 3 5 4 4 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:-1593833729 1073750107 16 0 415 0;}
@font-face
	{font-family:Consolas;
	panose-1:2 11 6 9 2 2 4 3 2 4;
	mso-font-charset:0;
	mso-generic-font-family:modern;
	mso-font-pitch:fixed;
	mso-font-signature:-520092929 1073806591 9 0 415 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-parent:"";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	line-height:115%;
	mso-pagination:widow-orphan;
	font-size:11.0pt;
	font-family:"Verdana","sans-serif";
	mso-ascii-font-family:Verdana;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:minor-fareast;
	mso-hansi-font-family:Verdana;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;
	color:windowtext;}
h1
	{mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-link:"Heading 1 Char";
	mso-style-next:Normal;
	margin-top:24.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	mso-pagination:widow-orphan lines-together;
	page-break-after:avoid;
	mso-outline-level:1;
	font-size:12.0pt;
	mso-bidi-font-size:14.0pt;
	font-family:"Verdana","sans-serif";
	mso-ascii-font-family:Verdana;
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:Verdana;
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:windowtext;
	mso-font-kerning:0pt;
	font-weight:bold;}
h2
	{mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-qformat:yes;
	mso-style-link:"Heading 2 Char";
	mso-style-next:Normal;
	margin-top:10.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	mso-pagination:widow-orphan lines-together;
	page-break-after:avoid;
	mso-outline-level:2;
	font-size:11.0pt;
	mso-bidi-font-size:13.0pt;
	font-family:"Verdana","sans-serif";
	mso-ascii-font-family:Verdana;
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:Verdana;
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:windowtext;
	font-weight:bold;}
h3
	{mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-qformat:yes;
	mso-style-link:"Heading 3 Char";
	mso-style-next:Normal;
	margin-top:10.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	mso-pagination:widow-orphan lines-together;
	page-break-after:avoid;
	mso-outline-level:3;
	font-size:11.0pt;
	font-family:"Verdana","sans-serif";
	mso-ascii-font-family:Verdana;
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:Verdana;
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:windowtext;
	font-weight:bold;}
p.MsoToc1, li.MsoToc1, div.MsoToc1
	{mso-style-update:auto;
	mso-style-noshow:yes;
	mso-style-priority:39;
	mso-style-next:Normal;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:0in;
	line-height:115%;
	mso-pagination:widow-orphan;
	font-size:11.0pt;
	font-family:"Verdana","sans-serif";
	mso-ascii-font-family:Verdana;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:minor-fareast;
	mso-hansi-font-family:Verdana;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;
	color:windowtext;}
p.MsoToc2, li.MsoToc2, div.MsoToc2
	{mso-style-update:auto;
	mso-style-noshow:yes;
	mso-style-priority:39;
	mso-style-next:Normal;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:11.0pt;
	line-height:115%;
	mso-pagination:widow-orphan;
	font-size:11.0pt;
	font-family:"Verdana","sans-serif";
	mso-ascii-font-family:Verdana;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:minor-fareast;
	mso-hansi-font-family:Verdana;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;
	color:windowtext;}
p.MsoToc3, li.MsoToc3, div.MsoToc3
	{mso-style-update:auto;
	mso-style-noshow:yes;
	mso-style-priority:39;
	mso-style-next:Normal;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:22.0pt;
	line-height:115%;
	mso-pagination:widow-orphan;
	font-size:11.0pt;
	font-family:"Verdana","sans-serif";
	mso-ascii-font-family:Verdana;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:minor-fareast;
	mso-hansi-font-family:Verdana;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;
	color:windowtext;}
p.MsoHeader, li.MsoHeader, div.MsoHeader
	{mso-style-noshow:yes;
	mso-style-priority:99;
	mso-style-link:"Header Char";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:normal;
	mso-pagination:widow-orphan;
	tab-stops:center 3.25in right 6.5in;
	font-size:11.0pt;
	font-family:"Verdana","sans-serif";
	mso-ascii-font-family:Verdana;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:minor-fareast;
	mso-hansi-font-family:Verdana;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;
	color:windowtext;}
p.MsoFooter, li.MsoFooter, div.MsoFooter
	{mso-style-priority:99;
	mso-style-link:"Footer Char";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:normal;
	mso-pagination:widow-orphan;
	tab-stops:center 3.25in right 6.5in;
	font-size:11.0pt;
	font-family:"Verdana","sans-serif";
	mso-ascii-font-family:Verdana;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:minor-fareast;
	mso-hansi-font-family:Verdana;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;
	color:windowtext;}
p.MsoSubtitle, li.MsoSubtitle, div.MsoSubtitle
	{mso-style-noshow:yes;
	mso-style-priority:11;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-link:"Subtitle Char";
	mso-style-next:Normal;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	line-height:115%;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Verdana","sans-serif";
	mso-ascii-font-family:Verdana;
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:Verdana;
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:black;
	mso-themecolor:accent1;
	letter-spacing:.75pt;
	font-style:italic;}
a:link, span.MsoHyperlink
	{mso-style-noshow:yes;
	mso-style-priority:99;
	color:windowtext;
	text-decoration:underline;
	text-underline:single;}
a:visited, span.MsoHyperlinkFollowed
	{mso-style-noshow:yes;
	mso-style-priority:99;
	color:black;
	mso-themecolor:followedhyperlink;
	text-decoration:underline;
	text-underline:single;}
em
	{mso-style-priority:20;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-parent:"";
	mso-ansi-font-size:11.0pt;
	font-family:"Courier New";
	mso-ascii-font-family:"Courier New";
	mso-hansi-font-family:"Courier New";
	mso-bidi-font-family:"Courier New";
	border:none windowtext 1.0pt;
	mso-border-alt:none windowtext 0in;
	padding:0in;
	background:black;
	mso-shading:white;
	mso-shading-themecolor:background1;
	mso-pattern:solid auto;
	font-style:normal;
	text-underline:white;
	mso-text-underline-themecolor:background1;}
p.MsoPlainText, li.MsoPlainText, div.MsoPlainText
	{mso-style-noshow:yes;
	mso-style-priority:99;
	mso-style-link:"Plain Text Char";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:normal;
	mso-pagination:widow-orphan;
	font-size:11.0pt;
	font-family:Consolas;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:minor-fareast;
	color:windowtext;}
p
	{mso-style-noshow:yes;
	mso-style-priority:99;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:.25in;
	margin-left:0in;
	line-height:16.8pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";
	mso-fareast-font-family:"Times New Roman";
	color:#515151;}
pre
	{mso-style-noshow:yes;
	mso-style-priority:99;
	mso-style-link:"HTML Preformatted Char";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:normal;
	mso-pagination:widow-orphan;
	tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt;
	font-size:10.0pt;
	font-family:"Courier New";
	mso-fareast-font-family:"Times New Roman";
	color:windowtext;
	mso-fareast-language:DE-AT;}
p.MsoAcetate, li.MsoAcetate, div.MsoAcetate
	{mso-style-noshow:yes;
	mso-style-priority:99;
	mso-style-link:"Balloon Text Char";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:normal;
	mso-pagination:widow-orphan;
	font-size:8.0pt;
	font-family:"Tahoma","sans-serif";
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:minor-fareast;
	color:windowtext;}
p.MsoNoSpacing, li.MsoNoSpacing, div.MsoNoSpacing
	{mso-style-noshow:yes;
	mso-style-priority:1;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	line-height:normal;
	mso-pagination:widow-orphan;
	font-size:11.0pt;
	font-family:"Verdana","sans-serif";
	mso-ascii-font-family:Verdana;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:minor-fareast;
	mso-hansi-font-family:Verdana;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;
	color:windowtext;}
p.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraph
	{mso-style-noshow:yes;
	mso-style-priority:34;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:.5in;
	mso-add-space:auto;
	line-height:115%;
	mso-pagination:widow-orphan;
	font-size:11.0pt;
	font-family:"Verdana","sans-serif";
	mso-ascii-font-family:Verdana;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:minor-fareast;
	mso-hansi-font-family:Verdana;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;
	color:windowtext;}
p.MsoListParagraphCxSpFirst, li.MsoListParagraphCxSpFirst, div.MsoListParagraphCxSpFirst
	{mso-style-noshow:yes;
	mso-style-priority:34;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-type:export-only;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	mso-add-space:auto;
	line-height:115%;
	mso-pagination:widow-orphan;
	font-size:11.0pt;
	font-family:"Verdana","sans-serif";
	mso-ascii-font-family:Verdana;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:minor-fareast;
	mso-hansi-font-family:Verdana;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;
	color:windowtext;}
p.MsoListParagraphCxSpMiddle, li.MsoListParagraphCxSpMiddle, div.MsoListParagraphCxSpMiddle
	{mso-style-noshow:yes;
	mso-style-priority:34;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-type:export-only;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	mso-add-space:auto;
	line-height:115%;
	mso-pagination:widow-orphan;
	font-size:11.0pt;
	font-family:"Verdana","sans-serif";
	mso-ascii-font-family:Verdana;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:minor-fareast;
	mso-hansi-font-family:Verdana;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;
	color:windowtext;}
p.MsoListParagraphCxSpLast, li.MsoListParagraphCxSpLast, div.MsoListParagraphCxSpLast
	{mso-style-noshow:yes;
	mso-style-priority:34;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-type:export-only;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:.5in;
	mso-add-space:auto;
	line-height:115%;
	mso-pagination:widow-orphan;
	font-size:11.0pt;
	font-family:"Verdana","sans-serif";
	mso-ascii-font-family:Verdana;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:minor-fareast;
	mso-hansi-font-family:Verdana;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;
	color:windowtext;}
span.MsoSubtleEmphasis
	{mso-style-priority:19;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-ansi-font-size:11.0pt;
	font-family:"Courier New";
	mso-ascii-font-family:"Courier New";
	mso-hansi-font-family:"Courier New";
	mso-bidi-font-family:"Courier New";
	color:windowtext;
	mso-bidi-font-style:italic;}
p.MsoTocHeading, li.MsoTocHeading, div.MsoTocHeading
	{mso-style-noshow:yes;
	mso-style-priority:39;
	mso-style-qformat:yes;
	mso-style-parent:"Heading 1";
	mso-style-next:Normal;
	margin-top:24.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	mso-pagination:widow-orphan lines-together;
	page-break-after:avoid;
	font-size:14.0pt;
	font-family:"Verdana","sans-serif";
	mso-ascii-font-family:Verdana;
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:Verdana;
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:windowtext;
	mso-fareast-language:JA;
	font-weight:bold;}
span.Heading1Char
	{mso-style-name:"Heading 1 Char";
	mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Heading 1";
	mso-ansi-font-size:12.0pt;
	mso-bidi-font-size:14.0pt;
	font-family:"Verdana","sans-serif";
	mso-ascii-font-family:Verdana;
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:Verdana;
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	font-weight:bold;}
span.Heading2Char
	{mso-style-name:"Heading 2 Char";
	mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Heading 2";
	mso-bidi-font-size:13.0pt;
	font-family:"Verdana","sans-serif";
	mso-ascii-font-family:Verdana;
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:Verdana;
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	font-weight:bold;}
span.Heading3Char
	{mso-style-name:"Heading 3 Char";
	mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Heading 3";
	font-family:"Verdana","sans-serif";
	mso-ascii-font-family:Verdana;
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:Verdana;
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	font-weight:bold;}
span.HTMLPreformattedChar
	{mso-style-name:"HTML Preformatted Char";
	mso-style-noshow:yes;
	mso-style-priority:99;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"HTML Preformatted";
	mso-ansi-font-size:10.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Courier New";
	mso-ascii-font-family:"Courier New";
	mso-fareast-font-family:"Times New Roman";
	mso-hansi-font-family:"Courier New";
	mso-bidi-font-family:"Courier New";
	mso-fareast-language:DE-AT;}
span.HeaderChar
	{mso-style-name:"Header Char";
	mso-style-noshow:yes;
	mso-style-priority:99;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:Header;}
span.FooterChar
	{mso-style-name:"Footer Char";
	mso-style-priority:99;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:Footer;}
span.SubtitleChar
	{mso-style-name:"Subtitle Char";
	mso-style-priority:11;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:Subtitle;
	mso-ansi-font-size:12.0pt;
	mso-bidi-font-size:12.0pt;
	font-family:"Verdana","sans-serif";
	mso-ascii-font-family:Verdana;
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:Verdana;
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:black;
	mso-themecolor:accent1;
	letter-spacing:.75pt;
	font-style:italic;}
span.PlainTextChar
	{mso-style-name:"Plain Text Char";
	mso-style-noshow:yes;
	mso-style-priority:99;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Plain Text";
	font-family:Consolas;
	mso-ascii-font-family:Consolas;
	mso-hansi-font-family:Consolas;
	mso-bidi-font-family:Consolas;
	mso-ansi-language:EN-US;}
span.BalloonTextChar
	{mso-style-name:"Balloon Text Char";
	mso-style-noshow:yes;
	mso-style-priority:99;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Balloon Text";
	mso-ansi-font-size:8.0pt;
	mso-bidi-font-size:8.0pt;
	font-family:"Tahoma","sans-serif";
	mso-ascii-font-family:Tahoma;
	mso-hansi-font-family:Tahoma;
	mso-bidi-font-family:Tahoma;}
p.Default, li.Default, div.Default
	{mso-style-name:Default;
	mso-style-noshow:yes;
	mso-style-priority:99;
	mso-style-unhide:no;
	mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:normal;
	mso-pagination:widow-orphan;
	mso-layout-grid-align:none;
	text-autospace:none;
	font-size:12.0pt;
	font-family:"Courier New";
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:minor-fareast;
	color:black;}
span.SpellE
	{mso-style-name:"";
	mso-spl-e:yes;}
span.GramE
	{mso-style-name:"";
	mso-gram-e:yes;}
.MsoChpDefault
	{mso-style-type:export-only;
	mso-default-props:yes;
	font-size:10.0pt;
	mso-ansi-font-size:10.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Verdana","sans-serif";
	mso-ascii-font-family:Verdana;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:minor-fareast;
	mso-hansi-font-family:Verdana;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;}
 /* Page Definitions */
 @page
	{mso-footnote-separator:url("Creating%20an%20Anti-AV%20scanner%20Article_files/header.htm") fs;
	mso-footnote-continuation-separator:url("Creating%20an%20Anti-AV%20scanner%20Article_files/header.htm") fcs;
	mso-endnote-separator:url("Creating%20an%20Anti-AV%20scanner%20Article_files/header.htm") es;
	mso-endnote-continuation-separator:url("Creating%20an%20Anti-AV%20scanner%20Article_files/header.htm") ecs;}
@page WordSection1
	{size:595.35pt 841.95pt;
	margin:70.85pt 70.85pt 56.7pt 70.85pt;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-paper-source:0;}
div.WordSection1
	{page:WordSection1;}
@page WordSection2
	{size:595.35pt 841.95pt;
	margin:56.7pt 70.85pt 70.85pt 70.85pt;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-footer:url("Creating%20an%20Anti-AV%20scanner%20Article_files/header.htm") f2;
	mso-paper-source:0;}
div.WordSection2
	{page:WordSection2;}
@page WordSection3
	{size:595.35pt 841.95pt;
	margin:70.85pt 70.85pt 56.7pt 70.85pt;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-footer:url("Creating%20an%20Anti-AV%20scanner%20Article_files/header.htm") f2;
	mso-paper-source:0;}
div.WordSection3
	{page:WordSection3;}
 /* List Definitions */
 @list l0
	{mso-list-id:1110707954;
	mso-list-type:hybrid;
	mso-list-template-ids:-481233570 67698703 67698713 67698715 67698703 67698713 67698715 67698703 67698713 67698715;}
@list l0:level1
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level2
	{mso-level-number-format:alpha-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level3
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:right;
	text-indent:-9.0pt;}
@list l0:level4
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level5
	{mso-level-number-format:alpha-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level6
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:right;
	text-indent:-9.0pt;}
@list l0:level7
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level8
	{mso-level-number-format:alpha-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level9
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:right;
	text-indent:-9.0pt;}
@list l1
	{mso-list-id:1131747007;
	mso-list-type:hybrid;
	mso-list-template-ids:-1440592104 -1262207890 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l1:level1
	{mso-level-number-format:bullet;
	mso-level-text:-;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:"Verdana","sans-serif";
	mso-fareast-font-family:Verdana;
	mso-fareast-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;}
@list l1:level2
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:"Courier New";}
@list l1:level3
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Wingdings;}
@list l1:level4
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l1:level5
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:"Courier New";}
@list l1:level6
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Wingdings;}
@list l1:level7
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l1:level8
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:"Courier New";}
@list l1:level9
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Wingdings;}
@list l2
	{mso-list-id:1632592886;
	mso-list-type:hybrid;
	mso-list-template-ids:-981201688 67698703 67698713 67698715 67698703 67698713 67698715 67698703 67698713 67698715;}
@list l2:level1
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l2:level2
	{mso-level-number-format:alpha-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l2:level3
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:right;
	text-indent:-9.0pt;}
@list l2:level4
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l2:level5
	{mso-level-number-format:alpha-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l2:level6
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:right;
	text-indent:-9.0pt;}
@list l2:level7
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l2:level8
	{mso-level-number-format:alpha-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l2:level9
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:right;
	text-indent:-9.0pt;}
ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:"Table Normal";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-priority:99;
	mso-style-parent:"";
	mso-padding-alt:0in 5.4pt 0in 5.4pt;
	mso-para-margin:0in;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Verdana","sans-serif";
	mso-ascii-font-family:Verdana;
	mso-ascii-theme-font:minor-latin;
	mso-hansi-font-family:Verdana;
	mso-hansi-theme-font:minor-latin;}
table.MsoTableGrid
	{mso-style-name:"Table Grid";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-priority:59;
	mso-style-unhide:no;
	border:solid black 1.0pt;
	mso-border-themecolor:text1;
	mso-border-alt:solid black .5pt;
	mso-border-themecolor:text1;
	mso-padding-alt:0in 5.4pt 0in 5.4pt;
	mso-border-insideh:.5pt solid black;
	mso-border-insideh-themecolor:text1;
	mso-border-insidev:.5pt solid black;
	mso-border-insidev-themecolor:text1;
	mso-para-margin:0in;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:11.0pt;
	font-family:"Verdana","sans-serif";
	mso-ascii-font-family:Verdana;
	mso-ascii-theme-font:minor-latin;
	mso-hansi-font-family:Verdana;
	mso-hansi-theme-font:minor-latin;}
</style>
<![endif]--><!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="2049"/>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]-->
</head>

<body bgcolor=white lang=EN-US link="#000000" vlink=black style='tab-interval:
35.4pt'>

<div class=WordSection1>

<p class=MsoNoSpacing><v:shapetype id="_x0000_t202" coordsize="21600,21600"
 o:spt="202" path="m,l,21600r21600,l21600,xe">
 <v:stroke joinstyle="miter"/>
 <v:path gradientshapeok="t" o:connecttype="rect"/>
</v:shapetype><v:shape id="Text_x0020_Box_x0020_2" o:spid="_x0000_s1028"
 type="#_x0000_t202" style='position:absolute;left:0;text-align:left;
 margin-left:20.65pt;margin-top:.4pt;width:568.8pt;height:102.75pt;z-index:251691008;
 visibility:visible;mso-wrap-style:square;mso-width-percent:0;
 mso-height-percent:0;mso-wrap-distance-left:9pt;mso-wrap-distance-top:0;
 mso-wrap-distance-right:9pt;mso-wrap-distance-bottom:0;
 mso-position-horizontal:absolute;mso-position-horizontal-relative:margin;
 mso-position-vertical:absolute;mso-position-vertical-relative:margin;
 mso-width-percent:0;mso-height-percent:0;mso-width-relative:page;
 mso-height-relative:page;v-text-anchor:middle' o:gfxdata="UEsDBBQABgAIAAAAIQC2gziS/gAAAOEBAAATAAAAW0NvbnRlbnRfVHlwZXNdLnhtbJSRQU7DMBBF
90jcwfIWJU67QAgl6YK0S0CoHGBkTxKLZGx5TGhvj5O2G0SRWNoz/78nu9wcxkFMGNg6quQqL6RA
0s5Y6ir5vt9lD1JwBDIwOMJKHpHlpr69KfdHjyxSmriSfYz+USnWPY7AufNIadK6MEJMx9ApD/oD
OlTrorhX2lFEilmcO2RdNtjC5xDF9pCuTyYBB5bi6bQ4syoJ3g9WQ0ymaiLzg5KdCXlKLjvcW893
SUOqXwnz5DrgnHtJTxOsQfEKIT7DmDSUCaxw7Rqn8787ZsmRM9e2VmPeBN4uqYvTtW7jvijg9N/y
JsXecLq0q+WD6m8AAAD//wMAUEsDBBQABgAIAAAAIQA4/SH/1gAAAJQBAAALAAAAX3JlbHMvLnJl
bHOkkMFqwzAMhu+DvYPRfXGawxijTi+j0GvpHsDYimMaW0Yy2fr2M4PBMnrbUb/Q94l/f/hMi1qR
JVI2sOt6UJgd+ZiDgffL8ekFlFSbvV0oo4EbChzGx4f9GRdb25HMsYhqlCwG5lrLq9biZkxWOiqY
22YiTra2kYMu1l1tQD30/bPm3wwYN0x18gb45AdQl1tp5j/sFB2T0FQ7R0nTNEV3j6o9feQzro1i
OWA14Fm+Q8a1a8+Bvu/d/dMb2JY5uiPbhG/ktn4cqGU/er3pcvwCAAD//wMAUEsDBBQABgAIAAAA
IQAJ6ZTkCwIAAP0DAAAOAAAAZHJzL2Uyb0RvYy54bWysU9tu2zAMfR+wfxD0vjh203Y14hRdig4D
ugvQ7gNkWbaFyaJGKbGzrx8lp1nQvQ17EcSLDnkOqfXtNBi2V+g12IrniyVnykpotO0q/v354d17
znwQthEGrKr4QXl+u3n7Zj26UhXQg2kUMgKxvhxdxfsQXJllXvZqEH4BTlkKtoCDCGRilzUoRkIf
TFYsl1fZCNg4BKm8J+/9HOSbhN+2SoavbetVYKbi1FtIJ6azjme2WYuyQ+F6LY9tiH/oYhDaUtET
1L0Igu1Q/wU1aIngoQ0LCUMGbaulShyITb58xeapF04lLiSOdyeZ/P+DlV/235DphmaXc2bFQDN6
VlNgH2BiRZRndL6krCdHeWEiN6Umqt49gvzhmYVtL2yn7hBh7JVoqL08vszOns44PoLU42doqIzY
BUhAU4tD1I7UYIROYzqcRhNbkeS8LoqL6ysKSYrlF8vVTXGZaojy5blDHz4qGFi8VBxp9gle7B99
iO2I8iUlVvNgdPOgjUlG3De1Ncj2gjal7mYCr7KMjbkW4qsZcPZQk8cSkXEkOdMNUz0dFayhORB3
hHkD6cfQpQf8xdlI21dx/3MnUHFmPlnS7yZfreK6JmN1eV2QgeeR+jwirCSoisuAnM3GNsxLvnOo
u55qzTOzcEeqtzrpEZud+zrOinYsyXT8D3GJz+2U9efXbn4DAAD//wMAUEsDBBQABgAIAAAAIQBI
l8q53gAAAAgBAAAPAAAAZHJzL2Rvd25yZXYueG1sTI8xT8MwFIR3JP6D9ZDYqJMUSgl5qRAVC2Io
LQvbS2ySgP0cYqdN/z3uRMfTne6+K1aTNWKvB985RkhnCQjNtVMdNwgfu5ebJQgfiBUZxxrhqD2s
ysuLgnLlDvyu99vQiFjCPieENoQ+l9LXrbbkZ67XHL0vN1gKUQ6NVAMdYrk1MkuShbTUcVxoqdfP
ra5/tqNFeF3f/Rqmt27abKpx/f2ZHXfeIl5fTU+PIIKewn8YTvgRHcrIVLmRlRcG4TadxyRC5D+5
6f3yAUSFkCWLOciykOcHyj8AAAD//wMAUEsBAi0AFAAGAAgAAAAhALaDOJL+AAAA4QEAABMAAAAA
AAAAAAAAAAAAAAAAAFtDb250ZW50X1R5cGVzXS54bWxQSwECLQAUAAYACAAAACEAOP0h/9YAAACU
AQAACwAAAAAAAAAAAAAAAAAvAQAAX3JlbHMvLnJlbHNQSwECLQAUAAYACAAAACEACemU5AsCAAD9
AwAADgAAAAAAAAAAAAAAAAAuAgAAZHJzL2Uyb0RvYy54bWxQSwECLQAUAAYACAAAACEASJfKud4A
AAAIAQAADwAAAAAAAAAAAAAAAABlBAAAZHJzL2Rvd25yZXYueG1sUEsFBgAAAAAEAAQA8wAAAHAF
AAAAAA==
" fillcolor="white [3212]" stroked="f">
 <v:textbox>
  <![if !mso]>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div>
    <p class=MsoNormal align=center style='text-align:center'><b
    style='mso-bidi-font-weight:normal'><span style='font-size:28.0pt;
    mso-bidi-font-size:33.5pt;line-height:115%;mso-ascii-font-family:Verdana;
    mso-ascii-theme-font:major-latin;mso-hansi-font-family:Verdana;mso-hansi-theme-font:
    major-latin;mso-bidi-font-family:Calibri'>Creating an Anti-AV scanner<o:p></o:p></span></b></p>
    <p class=MsoNormal align=center style='text-align:center'><b
    style='mso-bidi-font-weight:normal'><span style='font-size:28.0pt;
    mso-bidi-font-size:33.5pt;line-height:115%;mso-ascii-font-family:Verdana;
    mso-ascii-theme-font:major-latin;mso-hansi-font-family:Verdana;mso-hansi-theme-font:
    major-latin;mso-bidi-font-family:Calibri'>and blocking AVs<o:p></o:p></span></b></p>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  <![endif]></v:textbox>
 <w:wrap type="square" anchorx="margin" anchory="margin"/>
</v:shape><span lang=DE style='mso-ansi-language:DE'><o:p></o:p></span></p>

<p class=MsoNoSpacing><span lang=DE style='mso-ansi-language:DE'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNoSpacing><span lang=DE style='mso-ansi-language:DE'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNoSpacing><span lang=DE style='mso-ansi-language:DE'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNoSpacing><span lang=DE style='mso-ansi-language:DE'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNoSpacing><span lang=DE style='mso-ansi-language:DE'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNoSpacing><span lang=DE style='mso-ansi-language:DE'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNoSpacing><span lang=DE style='mso-ansi-language:DE'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNoSpacing><v:shape id="Text_x0020_Box_x0020_57" o:spid="_x0000_s1027"
 type="#_x0000_t202" style='position:absolute;left:0;text-align:left;
 margin-left:21.3pt;margin-top:9.65pt;width:486.65pt;height:359.25pt;z-index:251688960;
 visibility:visible;mso-wrap-style:square;mso-width-percent:0;
 mso-height-percent:0;mso-wrap-distance-left:9pt;mso-wrap-distance-top:0;
 mso-wrap-distance-right:9pt;mso-wrap-distance-bottom:0;
 mso-position-horizontal:absolute;mso-position-horizontal-relative:text;
 mso-position-vertical:absolute;mso-position-vertical-relative:text;
 mso-width-percent:0;mso-height-percent:0;mso-width-relative:page;
 mso-height-relative:margin;v-text-anchor:top' o:gfxdata="UEsDBBQABgAIAAAAIQC2gziS/gAAAOEBAAATAAAAW0NvbnRlbnRfVHlwZXNdLnhtbJSRQU7DMBBF
90jcwfIWJU67QAgl6YK0S0CoHGBkTxKLZGx5TGhvj5O2G0SRWNoz/78nu9wcxkFMGNg6quQqL6RA
0s5Y6ir5vt9lD1JwBDIwOMJKHpHlpr69KfdHjyxSmriSfYz+USnWPY7AufNIadK6MEJMx9ApD/oD
OlTrorhX2lFEilmcO2RdNtjC5xDF9pCuTyYBB5bi6bQ4syoJ3g9WQ0ymaiLzg5KdCXlKLjvcW893
SUOqXwnz5DrgnHtJTxOsQfEKIT7DmDSUCaxw7Rqn8787ZsmRM9e2VmPeBN4uqYvTtW7jvijg9N/y
JsXecLq0q+WD6m8AAAD//wMAUEsDBBQABgAIAAAAIQA4/SH/1gAAAJQBAAALAAAAX3JlbHMvLnJl
bHOkkMFqwzAMhu+DvYPRfXGawxijTi+j0GvpHsDYimMaW0Yy2fr2M4PBMnrbUb/Q94l/f/hMi1qR
JVI2sOt6UJgd+ZiDgffL8ekFlFSbvV0oo4EbChzGx4f9GRdb25HMsYhqlCwG5lrLq9biZkxWOiqY
22YiTra2kYMu1l1tQD30/bPm3wwYN0x18gb45AdQl1tp5j/sFB2T0FQ7R0nTNEV3j6o9feQzro1i
OWA14Fm+Q8a1a8+Bvu/d/dMb2JY5uiPbhG/ktn4cqGU/er3pcvwCAAD//wMAUEsDBBQABgAIAAAA
IQD1Ott8lQIAAK0FAAAOAAAAZHJzL2Uyb0RvYy54bWysVEtPGzEQvlfqf7B8L5ukWaARG5SCqCpF
gBoqzo7XJha2x7Wd7Ka/vmPv5gHlQtXLru355v3NXFy2RpON8EGBrejwZECJsBxqZZ8q+vPh5tM5
JSEyWzMNVlR0KwK9nH78cNG4iRjBCnQtPEEjNkwaV9FVjG5SFIGvhGHhBJywKJTgDYt49U9F7VmD
1o0uRoPBadGAr50HLkLA1+tOSKfZvpSCxzspg4hEVxRji/nr83eZvsX0gk2ePHMrxfsw2D9EYZiy
6HRv6ppFRtZe/WXKKO4hgIwnHEwBUioucg6YzXDwKpvFijmRc8HiBLcvU/h/Zvnt5t4TVVe0PKPE
MoM9ehBtJF+hJfiE9WlcmCBs4RAYW3zHPudcg5sDfw4IKY4wnUJAdKpHK71Jf8yUoCK2YLsve3LD
8fF0eD4YlyUlHGXj8nQ0PiuT4+Kg7nyI3wQYkg4V9djXHALbzEPsoDtI8hZAq/pGaZ0viUviSnuy
YcgCHYe98RcobUmDoXwuB9mwhaTeWdY2mRGZTb27lG+XYj7FrRYJo+0PIbGaOdM3fDPOhd37z+iE
kujqPYo9/hDVe5S7PFAjewYb98pGWfBdZ1+WrH7elUx2+L7jocs7lSC2yzbTKCPTyxLqLTLGQzdz
wfEbhc2bsxDvmcchQy7g4oh3+JEasPjQnyhZgf/91nvCI/dRSkmDQ1vR8GvNvKBEf7c4FV+G43Ga
8nwZl2cjvPhjyfJYYtfmCpARQ1xRjudjwke9O0oP5hH3yyx5RRGzHH1XNO6OV7FbJbifuJjNMgjn
2rE4twvHd4OSqPnQPjLvev5GpP4t7MabTV7RuMOm/liYrSNIlTl+qGpff9wJeUr6/ZWWzvE9ow5b
dvoHAAD//wMAUEsDBBQABgAIAAAAIQCLh+yO4QAAAAoBAAAPAAAAZHJzL2Rvd25yZXYueG1sTI/N
bsIwEITvlfoO1lbqBYETaPlJ46CqKhIcODT0ws3E2yRqvI5sA+nbdzm1x9kZzXybrwfbiQv60DpS
kE4SEEiVMy3VCj4Pm/ESRIiajO4coYIfDLAu7u9ynRl3pQ+8lLEWXEIh0wqaGPtMylA1aHWYuB6J
vS/nrY4sfS2N11cut52cJslcWt0SLzS6x7cGq+/ybBXsw3E7OvrtZlQGI3eI+/ddGpV6fBheX0BE
HOJfGG74jA4FM53cmUwQnYKn6ZyTfF/NQNz8JH1egTgpWMwWS5BFLv+/UPwCAAD//wMAUEsBAi0A
FAAGAAgAAAAhALaDOJL+AAAA4QEAABMAAAAAAAAAAAAAAAAAAAAAAFtDb250ZW50X1R5cGVzXS54
bWxQSwECLQAUAAYACAAAACEAOP0h/9YAAACUAQAACwAAAAAAAAAAAAAAAAAvAQAAX3JlbHMvLnJl
bHNQSwECLQAUAAYACAAAACEA9TrbfJUCAACtBQAADgAAAAAAAAAAAAAAAAAuAgAAZHJzL2Uyb0Rv
Yy54bWxQSwECLQAUAAYACAAAACEAi4fsjuEAAAAKAQAADwAAAAAAAAAAAAAAAADvBAAAZHJzL2Rv
d25yZXYueG1sUEsFBgAAAAAEAAQA8wAAAP0FAAAAAA==
" fillcolor="white [3201]" stroked="f" strokeweight=".5pt">
 <v:path arrowok="t"/>
 <v:textbox>
  <![if !mso]>
  <table cellpadding=0 cellspacing=0 width="100%">
   <tr>
    <td><![endif]>
    <div>
    <div style='mso-element:para-border-div;border:none;border-left:solid windowtext 1.0pt;
    mso-border-left-alt:solid windowtext .5pt;padding:0in 0in 0in 4.0pt'>
    <p class=MsoNoSpacing align=left style='text-align:left;border:none;
    mso-border-left-alt:solid windowtext .5pt;padding:0in;mso-padding-alt:0in 0in 0in 4.0pt'><b
    style='mso-bidi-font-weight:normal'><span style='font-size:9.0pt;
    mso-bidi-font-size:11.0pt;font-family:Consolas'>C:\Scanner&gt;&quot;Black
    Scanner.exe&quot; &quot;Anti-<span class=SpellE>Bootkit</span> Tools <span
    class=SpellE>Signatures.bin</span>&quot; C:\Temp\AV-Zoo<o:p></o:p></span></b></p>
    <p class=MsoNoSpacing align=left style='text-align:left;border:none;
    mso-border-left-alt:solid windowtext .5pt;padding:0in;mso-padding-alt:0in 0in 0in 4.0pt'><b
    style='mso-bidi-font-weight:normal'><span style='font-size:9.0pt;
    mso-bidi-font-size:11.0pt;font-family:Consolas'><o:p>&nbsp;</o:p></span></b></p>
    <p class=MsoNoSpacing align=left style='text-align:left;border:none;
    mso-border-left-alt:solid windowtext .5pt;padding:0in;mso-padding-alt:0in 0in 0in 4.0pt'><b
    style='mso-bidi-font-weight:normal'><span style='font-size:9.0pt;
    mso-bidi-font-size:11.0pt;font-family:Consolas'><span
    style='mso-spacerun:yes'> </span>Black Scanner<o:p></o:p></span></b></p>
    <p class=MsoNoSpacing align=left style='text-align:left;border:none;
    mso-border-left-alt:solid windowtext .5pt;padding:0in;mso-padding-alt:0in 0in 0in 4.0pt'><b
    style='mso-bidi-font-weight:normal'><span style='font-size:9.0pt;
    mso-bidi-font-size:11.0pt;font-family:Consolas'><span
    style='mso-spacerun:yes'> </span>Engine version <span class=GramE>1<span
    style='mso-spacerun:yes'> </span>Jan</span> 23 2012<o:p></o:p></span></b></p>
    <p class=MsoNoSpacing align=left style='text-align:left;border:none;
    mso-border-left-alt:solid windowtext .5pt;padding:0in;mso-padding-alt:0in 0in 0in 4.0pt'><b
    style='mso-bidi-font-weight:normal'><span style='font-size:9.0pt;
    mso-bidi-font-size:11.0pt;font-family:Consolas'><o:p>&nbsp;</o:p></span></b></p>
    <p class=MsoNoSpacing align=left style='text-align:left;border:none;
    mso-border-left-alt:solid windowtext .5pt;padding:0in;mso-padding-alt:0in 0in 0in 4.0pt'><b
    style='mso-bidi-font-weight:normal'><span style='font-size:9.0pt;
    mso-bidi-font-size:11.0pt;font-family:Consolas'>aswMBR.exe: Image Name
    infected<o:p></o:p></span></b></p>
    <p class=MsoNoSpacing align=left style='text-align:left;border:none;
    mso-border-left-alt:solid windowtext .5pt;padding:0in;mso-padding-alt:0in 0in 0in 4.0pt'><b
    style='mso-bidi-font-weight:normal'><span style='font-size:9.0pt;
    mso-bidi-font-size:11.0pt;font-family:Consolas'>aswMBR.exe: Icon infected<o:p></o:p></span></b></p>
    <p class=MsoNoSpacing align=left style='text-align:left;border:none;
    mso-border-left-alt:solid windowtext .5pt;padding:0in;mso-padding-alt:0in 0in 0in 4.0pt'><b
    style='mso-bidi-font-weight:normal'><span style='font-size:9.0pt;
    mso-bidi-font-size:11.0pt;font-family:Consolas'>aswMBR.exe: Icon infected<o:p></o:p></span></b></p>
    <p class=MsoNoSpacing align=left style='text-align:left;border:none;
    mso-border-left-alt:solid windowtext .5pt;padding:0in;mso-padding-alt:0in 0in 0in 4.0pt'><b
    style='mso-bidi-font-weight:normal'><span style='font-size:9.0pt;
    mso-bidi-font-size:11.0pt;font-family:Consolas'>aswMBR.exe: Icon infected<o:p></o:p></span></b></p>
    <p class=MsoNoSpacing align=left style='text-align:left;border:none;
    mso-border-left-alt:solid windowtext .5pt;padding:0in;mso-padding-alt:0in 0in 0in 4.0pt'><b
    style='mso-bidi-font-weight:normal'><span style='font-size:9.0pt;
    mso-bidi-font-size:11.0pt;font-family:Consolas'>aswMBR.exe: Icon infected<o:p></o:p></span></b></p>
    <p class=MsoNoSpacing align=left style='text-align:left;border:none;
    mso-border-left-alt:solid windowtext .5pt;padding:0in;mso-padding-alt:0in 0in 0in 4.0pt'><b
    style='mso-bidi-font-weight:normal'><span style='font-size:9.0pt;
    mso-bidi-font-size:11.0pt;font-family:Consolas'>aswMBR.exe: Icon infected<o:p></o:p></span></b></p>
    <p class=MsoNoSpacing align=left style='text-align:left;border:none;
    mso-border-left-alt:solid windowtext .5pt;padding:0in;mso-padding-alt:0in 0in 0in 4.0pt'><b
    style='mso-bidi-font-weight:normal'><span style='font-size:9.0pt;
    mso-bidi-font-size:11.0pt;font-family:Consolas'>aswMBR.exe: Icon infected<o:p></o:p></span></b></p>
    <p class=MsoNoSpacing align=left style='text-align:left;border:none;
    mso-border-left-alt:solid windowtext .5pt;padding:0in;mso-padding-alt:0in 0in 0in 4.0pt'><b
    style='mso-bidi-font-weight:normal'><span style='font-size:9.0pt;
    mso-bidi-font-size:11.0pt;font-family:Consolas'>aswMBR.exe: Version Info
    -&gt; Company infected<o:p></o:p></span></b></p>
    <p class=MsoNoSpacing align=left style='text-align:left;border:none;
    mso-border-left-alt:solid windowtext .5pt;padding:0in;mso-padding-alt:0in 0in 0in 4.0pt'><b
    style='mso-bidi-font-weight:normal'><span style='font-size:9.0pt;
    mso-bidi-font-size:11.0pt;font-family:Consolas'>aswMBR.exe: Version Info
    -&gt; Original File Name infected<o:p></o:p></span></b></p>
    <p class=MsoNoSpacing align=left style='text-align:left;border:none;
    mso-border-left-alt:solid windowtext .5pt;padding:0in;mso-padding-alt:0in 0in 0in 4.0pt'><b
    style='mso-bidi-font-weight:normal'><span style='font-size:9.0pt;
    mso-bidi-font-size:11.0pt;font-family:Consolas'>TDSSKiller.exe: Image Name
    infected<o:p></o:p></span></b></p>
    <p class=MsoNoSpacing align=left style='text-align:left;border:none;
    mso-border-left-alt:solid windowtext .5pt;padding:0in;mso-padding-alt:0in 0in 0in 4.0pt'><b
    style='mso-bidi-font-weight:normal'><span style='font-size:9.0pt;
    mso-bidi-font-size:11.0pt;font-family:Consolas'>TDSSKiller.exe: Section
    Name infected<o:p></o:p></span></b></p>
    <p class=MsoNoSpacing align=left style='text-align:left;border:none;
    mso-border-left-alt:solid windowtext .5pt;padding:0in;mso-padding-alt:0in 0in 0in 4.0pt'><b
    style='mso-bidi-font-weight:normal'><span style='font-size:9.0pt;
    mso-bidi-font-size:11.0pt;font-family:Consolas'>TDSSKiller.exe: Icon
    infected<o:p></o:p></span></b></p>
    <p class=MsoNoSpacing align=left style='text-align:left;border:none;
    mso-border-left-alt:solid windowtext .5pt;padding:0in;mso-padding-alt:0in 0in 0in 4.0pt'><b
    style='mso-bidi-font-weight:normal'><span style='font-size:9.0pt;
    mso-bidi-font-size:11.0pt;font-family:Consolas'>TDSSKiller.exe: Icon
    infected<o:p></o:p></span></b></p>
    <p class=MsoNoSpacing align=left style='text-align:left;border:none;
    mso-border-left-alt:solid windowtext .5pt;padding:0in;mso-padding-alt:0in 0in 0in 4.0pt'><b
    style='mso-bidi-font-weight:normal'><span style='font-size:9.0pt;
    mso-bidi-font-size:11.0pt;font-family:Consolas'>TDSSKiller.exe: Icon
    infected<o:p></o:p></span></b></p>
    <p class=MsoNoSpacing align=left style='text-align:left;border:none;
    mso-border-left-alt:solid windowtext .5pt;padding:0in;mso-padding-alt:0in 0in 0in 4.0pt'><b
    style='mso-bidi-font-weight:normal'><span style='font-size:9.0pt;
    mso-bidi-font-size:11.0pt;font-family:Consolas'>TDSSKiller.exe: Icon
    infected<o:p></o:p></span></b></p>
    <p class=MsoNoSpacing align=left style='text-align:left;border:none;
    mso-border-left-alt:solid windowtext .5pt;padding:0in;mso-padding-alt:0in 0in 0in 4.0pt'><b
    style='mso-bidi-font-weight:normal'><span style='font-size:9.0pt;
    mso-bidi-font-size:11.0pt;font-family:Consolas'>TDSSKiller.exe: Icon
    infected<o:p></o:p></span></b></p>
    <p class=MsoNoSpacing align=left style='text-align:left;border:none;
    mso-border-left-alt:solid windowtext .5pt;padding:0in;mso-padding-alt:0in 0in 0in 4.0pt'><b
    style='mso-bidi-font-weight:normal'><span style='font-size:9.0pt;
    mso-bidi-font-size:11.0pt;font-family:Consolas'>TDSSKiller.exe: Icon
    infected<o:p></o:p></span></b></p>
    <p class=MsoNoSpacing align=left style='text-align:left;border:none;
    mso-border-left-alt:solid windowtext .5pt;padding:0in;mso-padding-alt:0in 0in 0in 4.0pt'><b
    style='mso-bidi-font-weight:normal'><span style='font-size:9.0pt;
    mso-bidi-font-size:11.0pt;font-family:Consolas'>TDSSKiller.exe: Icon
    infected<o:p></o:p></span></b></p>
    <p class=MsoNoSpacing align=left style='text-align:left;border:none;
    mso-border-left-alt:solid windowtext .5pt;padding:0in;mso-padding-alt:0in 0in 0in 4.0pt'><b
    style='mso-bidi-font-weight:normal'><span style='font-size:9.0pt;
    mso-bidi-font-size:11.0pt;font-family:Consolas'>TDSSKiller.exe: Version
    Info -&gt; Company infected<o:p></o:p></span></b></p>
    <p class=MsoNoSpacing align=left style='text-align:left;border:none;
    mso-border-left-alt:solid windowtext .5pt;padding:0in;mso-padding-alt:0in 0in 0in 4.0pt'><b
    style='mso-bidi-font-weight:normal'><span style='font-size:9.0pt;
    mso-bidi-font-size:11.0pt;font-family:Consolas'>TDSSKiller.exe: Version
    Info -&gt; Original File Name infected<o:p></o:p></span></b></p>
    <p class=MsoNoSpacing align=left style='text-align:left;border:none;
    mso-border-left-alt:solid windowtext .5pt;padding:0in;mso-padding-alt:0in 0in 0in 4.0pt'><b
    style='mso-bidi-font-weight:normal'><span style='font-size:9.0pt;
    mso-bidi-font-size:11.0pt;font-family:Consolas'>TDSSKiller.exe: Certificate
    -&gt; O infected<o:p></o:p></span></b></p>
    <p class=MsoNoSpacing align=left style='text-align:left;border:none;
    mso-border-left-alt:solid windowtext .5pt;padding:0in;mso-padding-alt:0in 0in 0in 4.0pt'><b
    style='mso-bidi-font-weight:normal'><span style='font-size:9.0pt;
    mso-bidi-font-size:11.0pt;font-family:Consolas'>TDSSKiller.exe: Certificate
    -&gt; CN infected<o:p></o:p></span></b></p>
    <p class=MsoNoSpacing align=left style='text-align:left;border:none;
    mso-border-left-alt:solid windowtext .5pt;padding:0in;mso-padding-alt:0in 0in 0in 4.0pt'><span
    class=SpellE><span class=GramE><b style='mso-bidi-font-weight:normal'><span
    style='font-size:9.0pt;mso-bidi-font-size:11.0pt;font-family:Consolas'>gmer</span></b></span></span><b
    style='mso-bidi-font-weight:normal'><span style='font-size:9.0pt;
    mso-bidi-font-size:11.0pt;font-family:Consolas'> 1.0.15.14972.exe: Icon
    infected<o:p></o:p></span></b></p>
    <p class=MsoNoSpacing align=left style='text-align:left;border:none;
    mso-border-left-alt:solid windowtext .5pt;padding:0in;mso-padding-alt:0in 0in 0in 4.0pt'><b
    style='mso-bidi-font-weight:normal'><span style='font-size:9.0pt;
    mso-bidi-font-size:11.0pt;font-family:Consolas'>GMER 1.0.15.1508.exe: Icon
    infected<o:p></o:p></span></b></p>
    <p class=MsoNoSpacing align=left style='text-align:left;border:none;
    mso-border-left-alt:solid windowtext .5pt;padding:0in;mso-padding-alt:0in 0in 0in 4.0pt'><b
    style='mso-bidi-font-weight:normal'><span style='font-size:9.0pt;
    mso-bidi-font-size:11.0pt;font-family:Consolas'>GMER 1.0.15.15641.exe: Icon
    infected<o:p></o:p></span></b></p>
    <p class=MsoNoSpacing align=left style='text-align:left;border:none;
    mso-border-left-alt:solid windowtext .5pt;padding:0in;mso-padding-alt:0in 0in 0in 4.0pt'><b
    style='mso-bidi-font-weight:normal'><span style='font-size:9.0pt;
    mso-bidi-font-size:11.0pt;font-family:Consolas'>Gmer.exe: Image Name
    infected<o:p></o:p></span></b></p>
    <p class=MsoNoSpacing align=left style='text-align:left;border:none;
    mso-border-left-alt:solid windowtext .5pt;padding:0in;mso-padding-alt:0in 0in 0in 4.0pt'><b
    style='mso-bidi-font-weight:normal'><span style='font-size:9.0pt;
    mso-bidi-font-size:11.0pt;font-family:Consolas'>Gmer.exe: Icon infected<o:p></o:p></span></b></p>
    <p class=MsoNoSpacing align=left style='text-align:left;border:none;
    mso-border-left-alt:solid windowtext .5pt;padding:0in;mso-padding-alt:0in 0in 0in 4.0pt'><b
    style='mso-bidi-font-weight:normal'><span style='font-size:9.0pt;
    mso-bidi-font-size:11.0pt;font-family:Consolas'>gmer2u.exe: Icon infected<o:p></o:p></span></b></p>
    </div>
    </div>
    <![if !mso]></td>
   </tr>
  </table>
  <![endif]></v:textbox>
</v:shape><span lang=DE style='mso-ansi-language:DE'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNoSpacing><span lang=DE style='mso-ansi-language:DE'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNoSpacing><span lang=DE style='mso-ansi-language:DE'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNoSpacing><span lang=DE style='mso-ansi-language:DE'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNoSpacing><span lang=DE style='mso-ansi-language:DE'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNoSpacing><span lang=DE style='mso-ansi-language:DE'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNoSpacing><span lang=DE style='mso-ansi-language:DE'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNoSpacing><span lang=DE style='mso-ansi-language:DE'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNoSpacing><span lang=DE style='mso-ansi-language:DE'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNoSpacing><span lang=DE style='mso-ansi-language:DE'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNoSpacing><span lang=DE style='mso-ansi-language:DE'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNoSpacing><span lang=DE style='mso-ansi-language:DE'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNoSpacing><span lang=DE style='mso-ansi-language:DE'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNoSpacing><span lang=DE style='mso-ansi-language:DE'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNoSpacing><span lang=DE style='mso-ansi-language:DE'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNoSpacing><span lang=DE style='mso-ansi-language:DE'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNoSpacing><span lang=DE style='mso-ansi-language:DE'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNoSpacing><span lang=DE style='mso-ansi-language:DE'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNoSpacing><span lang=DE style='mso-ansi-language:DE'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNoSpacing><span lang=DE style='mso-ansi-language:DE'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNoSpacing><span lang=DE style='mso-ansi-language:DE'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNoSpacing><span lang=DE style='mso-ansi-language:DE'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNoSpacing><span lang=DE style='mso-ansi-language:DE'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNoSpacing><span lang=DE style='mso-ansi-language:DE'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNoSpacing><span lang=DE style='mso-ansi-language:DE'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNoSpacing><span lang=DE style='mso-ansi-language:DE'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNoSpacing><span lang=DE style='mso-ansi-language:DE'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNoSpacing><span lang=DE style='mso-ansi-language:DE'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<br style='mso-ignore:vglayout' clear=ALL>

<p class=MsoNoSpacing><b style='mso-bidi-font-weight:normal'>Creating an
Anti-AV scanner<o:p></o:p></b></p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing>There is malware in the wild that blocks anti-viruses
from execution. They usually use a blacklist of hard coded file or process
names. While that turned out to be working quite good, a more decent solution
would be making a full anti-AV scanner based on real signatures.</p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing>Prior to this article I was watching a very interesting
movement: A <span class=SpellE>bootkit</span> was blocking <span class=SpellE>TDSSKillers</span>
execution by patching the entry point, and they (lame Kaspersky) responded by
adding a TLS callback to their executable (that gets executed before the
patched entry point).</p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing><span class=SpellE>TDSSKiller</span> as anti-rootkit tool
is a very good example, as it is the most aggressive (evil) one of its kind. It
is packed like a virus, uses rootkit-like features and has pseudo heuristic
signatures for MBRs such as <i style='mso-bidi-font-style:normal'>Rootkit.Win32.BackBoot.gen</i>.
By making a signature over 440 bytes false positives are confirmed by oath.</p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing>In a discussion about this (prior to this paper) a very
good developer came up with the rootkit paradox:</p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing><i style='mso-bidi-font-style:normal'><span
style='mso-tab-count:1'> </span>There is what we call the &quot;rootkit
paradox,&quot; namely, the more you try to hide the easier you are to find. The
reason is because everything you do to hide produces artifacts by which you can
be detected. So you have to hide not only the original rootkit, but also all of
the hooks that you use to hide. Once you have hidden your hooks you then have
to hide everything you did to hide the hooks, and so on. Eventually the rootkit
collapses under its own weight.<o:p></o:p></i></p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing>Obviously the solution to this rootkit paradox is either
not doing any hooks (and being exposed to anti-viruses), or to block the
execution of AVs in advance.</p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing>For some simple solutions in the wild that rely on the
file name of the AV it is easy enough to rename the AV to bypass that. But what
is about a full featured anti-AV scanner?</p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing>Important: This is research here and should be considered
as proof of concept.</p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing><span style='mso-ascii-font-family:Verdana;mso-hansi-font-family:
Verdana'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNoSpacing><v:shapetype id="_x0000_t75" coordsize="21600,21600"
 o:spt="75" o:preferrelative="t" path="m@4@5l@4@11@9@11@9@5xe" filled="f"
 stroked="f">
 <v:stroke joinstyle="miter"/>
 <v:formulas>
  <v:f eqn="if lineDrawn pixelLineWidth 0"/>
  <v:f eqn="sum @0 1 0"/>
  <v:f eqn="sum 0 0 @1"/>
  <v:f eqn="prod @2 1 2"/>
  <v:f eqn="prod @3 21600 pixelWidth"/>
  <v:f eqn="prod @3 21600 pixelHeight"/>
  <v:f eqn="sum @0 0 1"/>
  <v:f eqn="prod @6 1 2"/>
  <v:f eqn="prod @7 21600 pixelWidth"/>
  <v:f eqn="sum @8 21600 0"/>
  <v:f eqn="prod @7 21600 pixelHeight"/>
  <v:f eqn="sum @10 21600 0"/>
 </v:formulas>
 <v:path o:extrusionok="f" gradientshapeok="t" o:connecttype="rect"/>
 <o:lock v:ext="edit" aspectratio="t"/>
</v:shapetype><v:shape id="Bild_x0020_1" o:spid="_x0000_s1026" type="#_x0000_t75"
 style='position:absolute;left:0;text-align:left;margin-left:1.8pt;
 margin-top:3.1pt;width:122.25pt;height:20.25pt;z-index:-251654144;
 visibility:visible;mso-wrap-style:square;mso-width-percent:0;
 mso-height-percent:0;mso-wrap-distance-left:9pt;mso-wrap-distance-top:0;
 mso-wrap-distance-right:9pt;mso-wrap-distance-bottom:0;
 mso-position-horizontal:absolute;mso-position-horizontal-relative:text;
 mso-position-vertical:absolute;mso-position-vertical-relative:text;
 mso-width-percent:0;mso-height-percent:0;mso-width-relative:page;
 mso-height-relative:page'>
 <v:imagedata src="Creating%20an%20Anti-AV%20scanner%20Article_files/image001.png"
  o:title="" grayscale="t" bilevel="t"/>
</v:shape><span style='mso-ascii-font-family:Verdana;mso-hansi-font-family:
Verdana'><o:p></o:p></span></p>

<p class=MsoNoSpacing><span style='mso-ascii-font-family:Verdana;mso-hansi-font-family:
Verdana'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNoSpacing><span style='mso-ascii-font-family:Verdana;mso-hansi-font-family:
Verdana'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNoSpacing><i style='mso-bidi-font-style:normal'><span
style='mso-ascii-font-family:Verdana;mso-hansi-font-family:Verdana'>Peter
Kleissner</span></i><span style='mso-ascii-font-family:Verdana;mso-hansi-font-family:
Verdana;mso-fareast-language:DE-AT;mso-no-proof:yes'>, Software Development G.</span><i
style='mso-bidi-font-style:normal'><span style='mso-ascii-font-family:Verdana;
mso-hansi-font-family:Verdana'><o:p></o:p></span></i></p>

<p class=MsoNoSpacing><span style='mso-ascii-font-family:Verdana;mso-hansi-font-family:
Verdana'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<span style='font-size:11.0pt;font-family:"Verdana","sans-serif";mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:"Times New Roman";mso-fareast-theme-font:
minor-fareast;mso-hansi-theme-font:minor-latin;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US;mso-fareast-language:
EN-US;mso-bidi-language:AR-SA'><br clear=all style='mso-special-character:line-break;
page-break-before:always'>
</span>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<h1><a name="_Toc318983980">Table of Contents</a></h1>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoToc1 style='tab-stops:right lined 453.15pt'><!--[if supportFields]><span
style='mso-element:field-begin'></span><span
style='mso-spacerun:yes'></span>TOC \o &quot;1-3&quot; \h \z \u <span
style='mso-element:field-separator'></span><![endif]--><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc318983980">Table
of Contents<span style='display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 lined'> </span></span><!--[if supportFields]><span
style='display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-begin'></span> PAGEREF _Toc318983980 \h <span
style='mso-element:field-separator'></span></span><![endif]--><span
style='display:none;mso-hide:screen;text-decoration:none;text-underline:none'>3<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310038003900380033003900380030000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc1 style='tab-stops:right lined 453.15pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc318983981">The
objective<span style='display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 lined'> </span></span><!--[if supportFields]><span
style='display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-begin'></span> PAGEREF _Toc318983981 \h <span
style='mso-element:field-separator'></span></span><![endif]--><span
style='display:none;mso-hide:screen;text-decoration:none;text-underline:none'>4<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310038003900380033003900380031000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc1 style='tab-stops:right lined 453.15pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc318983982">Signature
Database<span style='display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 lined'> </span></span><!--[if supportFields]><span
style='display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-begin'></span> PAGEREF _Toc318983982 \h <span
style='mso-element:field-separator'></span></span><![endif]--><span
style='display:none;mso-hide:screen;text-decoration:none;text-underline:none'>6<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310038003900380033003900380032000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc1 style='tab-stops:right lined 453.15pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc318983983">Gmer<span
style='display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 lined'> </span></span><!--[if supportFields]><span
style='display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-begin'></span> PAGEREF _Toc318983983 \h <span
style='mso-element:field-separator'></span></span><![endif]--><span
style='display:none;mso-hide:screen;text-decoration:none;text-underline:none'>7<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310038003900380033003900380033000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc1 style='tab-stops:right lined 453.15pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc318983984">TDSSKiller<span
style='display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 lined'> </span></span><!--[if supportFields]><span
style='display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-begin'></span> PAGEREF _Toc318983984 \h <span
style='mso-element:field-separator'></span></span><![endif]--><span
style='display:none;mso-hide:screen;text-decoration:none;text-underline:none'>8<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310038003900380033003900380034000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc1 style='tab-stops:right lined 453.15pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc318983985">Preventing
files from being executed<span style='display:none;mso-hide:screen;text-decoration:
none;text-underline:none'><span style='mso-tab-count:1 lined'>_ </span></span><!--[if supportFields]><span
style='display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-begin'></span> PAGEREF _Toc318983985 \h <span
style='mso-element:field-separator'></span></span><![endif]--><span
style='display:none;mso-hide:screen;text-decoration:none;text-underline:none'>10<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310038003900380033003900380035000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc1 style='tab-stops:right lined 453.15pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc318983986">Parsing
Certificates<span style='display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 lined'> </span></span><!--[if supportFields]><span
style='display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-begin'></span> PAGEREF _Toc318983986 \h <span
style='mso-element:field-separator'></span></span><![endif]--><span
style='display:none;mso-hide:screen;text-decoration:none;text-underline:none'>12<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310038003900380033003900380036000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc1 style='tab-stops:right lined 453.15pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc318983987">AV
Zoo<span style='display:none;mso-hide:screen;text-decoration:none;text-underline:
none'><span style='mso-tab-count:1 lined'> </span></span><!--[if supportFields]><span
style='display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-begin'></span> PAGEREF _Toc318983987 \h <span
style='mso-element:field-separator'></span></span><![endif]--><span
style='display:none;mso-hide:screen;text-decoration:none;text-underline:none'>14<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310038003900380033003900380037000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc1 style='tab-stops:right lined 453.15pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc318983988">Behind
the scenes  technical implementation<span style='display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 lined'>_ </span></span><!--[if supportFields]><span
style='display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-begin'></span> PAGEREF _Toc318983988 \h <span
style='mso-element:field-separator'></span></span><![endif]--><span
style='display:none;mso-hide:screen;text-decoration:none;text-underline:none'>15<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310038003900380033003900380038000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc1 style='tab-stops:right lined 453.15pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc318983989">Conclusion<span
style='display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 lined'>_ </span></span><!--[if supportFields]><span
style='display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-begin'></span> PAGEREF _Toc318983989 \h <span
style='mso-element:field-separator'></span></span><![endif]--><span
style='display:none;mso-hide:screen;text-decoration:none;text-underline:none'>16<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310038003900380033003900380039000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc1 style='tab-stops:right lined 453.15pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc318983990">References<span
style='display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 lined'> </span></span><!--[if supportFields]><span
style='display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-begin'></span> PAGEREF _Toc318983990 \h <span
style='mso-element:field-separator'></span></span><![endif]--><span
style='display:none;mso-hide:screen;text-decoration:none;text-underline:none'>17<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310038003900380033003900390030000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span><o:p></o:p></span></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing><!--[if supportFields]><span style='mso-element:field-end'></span><![endif]--><o:p>&nbsp;</o:p></p>

</div>

<span style='font-size:11.0pt;line-height:115%;font-family:"Verdana","sans-serif";
mso-ascii-theme-font:minor-latin;mso-fareast-font-family:"Times New Roman";
mso-fareast-theme-font:minor-fareast;mso-hansi-theme-font:minor-latin;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US;mso-fareast-language:EN-US;mso-bidi-language:AR-SA'><br
clear=all style='page-break-before:always;mso-break-type:section-break'>
</span>

<div class=WordSection2>

<h1 style='margin-top:0in'><a name="_Toc318983981">The objective</a></h1>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing>We need a scanner that checks every file that is executed
and stops its execution in case it is detected as an anti-virus. This also
includes parts of anti-virus programs like libraries or drivers. We totally
want to block them, including special removers and rootkit detection tools.</p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing>The technical requirements are: We only need to scan PE
files loaded in memory. The code has to be portable, working both in user-mode
and kernel-mode. Since this not an AV but an anti-AV we can rely on one
important fact: AV files are easily identifiable and verifiable through
meta-data such as file names, descriptions and certificates.</p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing>Meta-data in PE files that can be used for AV file
identification are:</p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing style='margin-left:.5in;text-indent:-.25in;mso-list:l1 level1 lfo2'><![if !supportLists]><span
style='mso-ascii-font-family:Verdana;mso-fareast-font-family:Verdana;
mso-hansi-font-family:Verdana;mso-bidi-font-family:Verdana'><span
style='mso-list:Ignore'>-<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>Image name</p>

<p class=MsoNoSpacing style='margin-left:.5in;text-indent:-.25in;mso-list:l1 level1 lfo2'><![if !supportLists]><span
style='mso-ascii-font-family:Verdana;mso-fareast-font-family:Verdana;
mso-hansi-font-family:Verdana;mso-bidi-font-family:Verdana'><span
style='mso-list:Ignore'>-<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>Icon</p>

<p class=MsoNoSpacing style='margin-left:.5in;text-indent:-.25in;mso-list:l1 level1 lfo2'><![if !supportLists]><span
style='mso-ascii-font-family:Verdana;mso-fareast-font-family:Verdana;
mso-hansi-font-family:Verdana;mso-bidi-font-family:Verdana'><span
style='mso-list:Ignore'>-<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>Version Info -&gt; Original File Name</p>

<p class=MsoNoSpacing style='margin-left:.5in;text-indent:-.25in;mso-list:l1 level1 lfo2'><![if !supportLists]><span
style='mso-ascii-font-family:Verdana;mso-fareast-font-family:Verdana;
mso-hansi-font-family:Verdana;mso-bidi-font-family:Verdana'><span
style='mso-list:Ignore'>-<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>Version Info -&gt; Company</p>

<p class=MsoNoSpacing style='margin-left:.5in;text-indent:-.25in;mso-list:l1 level1 lfo2'><![if !supportLists]><span
style='mso-ascii-font-family:Verdana;mso-fareast-font-family:Verdana;
mso-hansi-font-family:Verdana;mso-bidi-font-family:Verdana'><span
style='mso-list:Ignore'>-<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>Section Name</p>

<p class=MsoNoSpacing style='margin-left:.5in;text-indent:-.25in;mso-list:l1 level1 lfo2'><![if !supportLists]><span
style='mso-ascii-font-family:Verdana;mso-fareast-font-family:Verdana;
mso-hansi-font-family:Verdana;mso-bidi-font-family:Verdana'><span
style='mso-list:Ignore'>-<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>Certificate -&gt; Organization Name (O)</p>

<p class=MsoNoSpacing style='margin-left:.5in;text-indent:-.25in;mso-list:l1 level1 lfo2'><![if !supportLists]><span
style='mso-ascii-font-family:Verdana;mso-fareast-font-family:Verdana;
mso-hansi-font-family:Verdana;mso-bidi-font-family:Verdana'><span
style='mso-list:Ignore'>-<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>Certificate -&gt; Common Name (CN)</p>

<p class=MsoNoSpacing style='margin-left:.5in;text-indent:-.25in;mso-list:l1 level1 lfo2'><![if !supportLists]><span
style='mso-ascii-font-family:Verdana;mso-fareast-font-family:Verdana;
mso-hansi-font-family:Verdana;mso-bidi-font-family:Verdana'><span
style='mso-list:Ignore'>-<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>Certificate -&gt; Fingerprint</p>

<p class=MsoNoSpacing style='margin-left:.5in;text-indent:-.25in;mso-list:l1 level1 lfo2'><![if !supportLists]><span
style='mso-ascii-font-family:Verdana;mso-fareast-font-family:Verdana;
mso-hansi-font-family:Verdana;mso-bidi-font-family:Verdana'><span
style='mso-list:Ignore'>-<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>Debug data</p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing>Some remover tools are packed (some by UPX, some by
custom ones); therefore some information could be encrypted. This is usually
the case for the string table (as part of the resources) or the debug data.</p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing>The basic concept of AVs is take the file and scan all
signatures over it. This is obviously slow (but necessary). In our case,
however, we can do it reverse: Take the meta-data, hash it and look it up in a
(blacklist) tree. The time to scan a file is then nearly always the same: Doing
the hashes, comparing them to the list (tree).</p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing>The signatures are stored in trees (which are none,
technically just lists but it sounds better) of the hashes calculated from the
meta-data. Candidates for the hashing algorithm would be CRC32, MD5 and SHA-1,
as they are widely used and easy to implement. In my solution I use CRC32 as it
just uses a <span class=SpellE>dword</span> for every hash (which makes the
lookup pretty fast then).</p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing>Each hash tree identifies some meta-data type:</p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;mso-border-alt:solid black .5pt;
 mso-border-themecolor:text1;mso-yfti-tbllook:1184;mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td width=43 valign=top style='width:.45in;border:solid black 1.0pt;
  mso-border-themecolor:text1;mso-border-alt:solid black .5pt;mso-border-themecolor:
  text1;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNoSpacing align=center style='text-align:center'>1</p>
  </td>
  <td width=204 valign=top style='width:153.0pt;border:solid black 1.0pt;
  mso-border-themecolor:text1;border-left:none;mso-border-left-alt:solid black .5pt;
  mso-border-left-themecolor:text1;mso-border-alt:solid black .5pt;mso-border-themecolor:
  text1;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNoSpacing align=left style='text-align:left'>Image Name</p>
  </td>
  <td width=720 valign=top style='width:539.8pt;border:solid black 1.0pt;
  mso-border-themecolor:text1;border-left:none;mso-border-left-alt:solid black .5pt;
  mso-border-left-themecolor:text1;mso-border-alt:solid black .5pt;mso-border-themecolor:
  text1;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>TDSSKiller.exe,
  Gmer.exe, aswMBR.exe<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td width=43 valign=top style='width:.45in;border:solid black 1.0pt;
  mso-border-themecolor:text1;border-top:none;mso-border-top-alt:solid black .5pt;
  mso-border-top-themecolor:text1;mso-border-alt:solid black .5pt;mso-border-themecolor:
  text1;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNoSpacing align=center style='text-align:center'>2</p>
  </td>
  <td width=204 valign=top style='width:153.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;mso-border-bottom-themecolor:text1;
  border-right:solid black 1.0pt;mso-border-right-themecolor:text1;mso-border-top-alt:
  solid black .5pt;mso-border-top-themecolor:text1;mso-border-left-alt:solid black .5pt;
  mso-border-left-themecolor:text1;mso-border-alt:solid black .5pt;mso-border-themecolor:
  text1;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNoSpacing align=left style='text-align:left'>Icon</p>
  </td>
  <td width=720 valign=top style='width:539.8pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;mso-border-bottom-themecolor:text1;
  border-right:solid black 1.0pt;mso-border-right-themecolor:text1;mso-border-top-alt:
  solid black .5pt;mso-border-top-themecolor:text1;mso-border-left-alt:solid black .5pt;
  mso-border-left-themecolor:text1;mso-border-alt:solid black .5pt;mso-border-themecolor:
  text1;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNoSpacing><span style='font-family:"Courier New";mso-no-proof:
  yes'><v:shape id="Picture_x0020_52" o:spid="_x0000_i1033" type="#_x0000_t75"
   style='width:24pt;height:24pt;visibility:visible;mso-wrap-style:square'>
   <v:imagedata src="Creating%20an%20Anti-AV%20scanner%20Article_files/image002.png"
    o:title=""/>
  </v:shape></span><span style='font-family:"Courier New"'>, <span
  style='mso-no-proof:yes'><v:shape id="Picture_x0020_1" o:spid="_x0000_i1032"
   type="#_x0000_t75" style='width:24pt;height:24pt;visibility:visible;
   mso-wrap-style:square'>
   <v:imagedata src="Creating%20an%20Anti-AV%20scanner%20Article_files/image003.png"
    o:title=""/>
  </v:shape></span>, <span style='mso-no-proof:yes'><v:shape id="Picture_x0020_53"
   o:spid="_x0000_i1031" type="#_x0000_t75" style='width:24pt;height:24pt;
   visibility:visible;mso-wrap-style:square'>
   <v:imagedata src="Creating%20an%20Anti-AV%20scanner%20Article_files/image004.png"
    o:title=""/>
  </v:shape></span>, </span><span style='mso-no-proof:yes'><v:shape id="Picture_x0020_56"
   o:spid="_x0000_i1030" type="#_x0000_t75" style='width:24pt;height:24pt;
   visibility:visible;mso-wrap-style:square'>
   <v:imagedata src="Creating%20an%20Anti-AV%20scanner%20Article_files/image005.png"
    o:title=""/>
  </v:shape></span><span style='font-family:"Courier New"'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td width=43 valign=top style='width:.45in;border:solid black 1.0pt;
  mso-border-themecolor:text1;border-top:none;mso-border-top-alt:solid black .5pt;
  mso-border-top-themecolor:text1;mso-border-alt:solid black .5pt;mso-border-themecolor:
  text1;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNoSpacing align=center style='text-align:center'>3</p>
  </td>
  <td width=204 valign=top style='width:153.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;mso-border-bottom-themecolor:text1;
  border-right:solid black 1.0pt;mso-border-right-themecolor:text1;mso-border-top-alt:
  solid black .5pt;mso-border-top-themecolor:text1;mso-border-left-alt:solid black .5pt;
  mso-border-left-themecolor:text1;mso-border-alt:solid black .5pt;mso-border-themecolor:
  text1;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNoSpacing align=left style='text-align:left'>Company Name</p>
  </td>
  <td width=720 valign=top style='width:539.8pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;mso-border-bottom-themecolor:text1;
  border-right:solid black 1.0pt;mso-border-right-themecolor:text1;mso-border-top-alt:
  solid black .5pt;mso-border-top-themecolor:text1;mso-border-left-alt:solid black .5pt;
  mso-border-left-themecolor:text1;mso-border-alt:solid black .5pt;mso-border-themecolor:
  text1;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>Kaspersky Lab
  ZAO, Kaspersky Lab<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3;mso-yfti-lastrow:yes'>
  <td width=43 valign=top style='width:.45in;border:solid black 1.0pt;
  mso-border-themecolor:text1;border-top:none;mso-border-top-alt:solid black .5pt;
  mso-border-top-themecolor:text1;mso-border-alt:solid black .5pt;mso-border-themecolor:
  text1;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNoSpacing align=center style='text-align:center'>4</p>
  </td>
  <td width=204 valign=top style='width:153.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;mso-border-bottom-themecolor:text1;
  border-right:solid black 1.0pt;mso-border-right-themecolor:text1;mso-border-top-alt:
  solid black .5pt;mso-border-top-themecolor:text1;mso-border-left-alt:solid black .5pt;
  mso-border-left-themecolor:text1;mso-border-alt:solid black .5pt;mso-border-themecolor:
  text1;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNoSpacing align=left style='text-align:left'>PE Section Names</p>
  </td>
  <td width=720 valign=top style='width:539.8pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;mso-border-bottom-themecolor:text1;
  border-right:solid black 1.0pt;mso-border-right-themecolor:text1;mso-border-top-alt:
  solid black .5pt;mso-border-top-themecolor:text1;mso-border-left-alt:solid black .5pt;
  mso-border-left-themecolor:text1;mso-border-alt:solid black .5pt;mso-border-themecolor:
  text1;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNoSpacing><span style='font-family:"Courier New"'>.<span
  class=SpellE>pklav</span><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing>Then there should be another tree for the certificate
fingerprints, to explicitly blacklist them as well.</p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing>These hash trees do not equal the signature types.
Rather, there are different types for the specific info that are checked:</p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas;color:blue'>#define</span><span style='font-size:
9.5pt;font-family:Consolas'> BLACK_SIG_TYPE_IMAGENAME<span
style='mso-spacerun:yes'> </span>1<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas;color:blue'>#define</span><span style='font-size:
9.5pt;font-family:Consolas'> BLACK_SIG_TYPE_RESOURCE_ICON<span
style='mso-spacerun:yes'> </span>2<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas;color:blue'>#define</span><span style='font-size:
9.5pt;font-family:Consolas'> BLACK_SIG_TYPE_VERSION_INFO_ORIGINAL_FILENAME<span
style='mso-spacerun:yes'> </span>3<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas;color:blue'>#define</span><span style='font-size:
9.5pt;font-family:Consolas'> BLACK_SIG_TYPE_VERSION_INFO_COMPANY<span
style='mso-spacerun:yes'> </span>4<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas;color:blue'>#define</span><span style='font-size:
9.5pt;font-family:Consolas'> BLACK_SIG_TYPE_SECTION_NAME<span
style='mso-spacerun:yes'> </span>5<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas;color:blue'>#define</span><span style='font-size:
9.5pt;font-family:Consolas'> BLACK_SIG_TYPE_CERTIFICATE_CN<span
style='mso-spacerun:yes'> </span>6<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas;color:blue'>#define</span><span style='font-size:
9.5pt;font-family:Consolas'> BLACK_SIG_TYPE_CERTIFICATE_O<span
style='mso-spacerun:yes'> </span>7<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNoSpacing>The image name and the version info -&gt; original
file name signature types for example use the same hash tree (Image Name).</p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<span style='font-size:11.0pt;line-height:115%;font-family:"Verdana","sans-serif";
mso-ascii-theme-font:minor-latin;mso-fareast-font-family:"Times New Roman";
mso-fareast-theme-font:minor-fareast;mso-hansi-theme-font:minor-latin;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US;mso-fareast-language:EN-US;mso-bidi-language:AR-SA'><br
clear=all style='mso-special-character:line-break;page-break-before:always'>
</span>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<h1><a name="_Toc318983982">Signature Database</a></h1>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing>A scanner engine can only be as good (or in <span
class=SpellE>Aviras</span> case as worse) as its signature database. The
example used and shown at the first page of this article is Anti-<span
class=SpellE>Bootkit</span> Tools Signatures. Its source looks like this:</p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing><span style='font-size:9.0pt;mso-bidi-font-size:11.0pt;
font-family:"Courier New"'># blacklist <span class=SpellE>TDSSKiller</span> and
Kaspersky Lab<o:p></o:p></span></p>

<p class=MsoNoSpacing><span style='font-size:9.0pt;mso-bidi-font-size:11.0pt;
font-family:"Courier New"'>1<span style='mso-spacerun:yes'>
</span>TDSSKiller.exe<o:p></o:p></span></p>

<p class=MsoNoSpacing><span style='font-size:9.0pt;mso-bidi-font-size:11.0pt;
font-family:"Courier New"'>2<span style='mso-spacerun:yes'> </span>CRC32<span
style='mso-spacerun:yes'> </span>1561770547<o:p></o:p></span></p>

<p class=MsoNoSpacing><span style='font-size:9.0pt;mso-bidi-font-size:11.0pt;
font-family:"Courier New"'>2<span style='mso-spacerun:yes'> </span>CRC32<span
style='mso-spacerun:yes'> </span>1148540081<o:p></o:p></span></p>

<p class=MsoNoSpacing><span style='font-size:9.0pt;mso-bidi-font-size:11.0pt;
font-family:"Courier New"'>2<span style='mso-spacerun:yes'> </span>CRC32<span
style='mso-spacerun:yes'> </span>616636565<o:p></o:p></span></p>

<p class=MsoNoSpacing><span style='font-size:9.0pt;mso-bidi-font-size:11.0pt;
font-family:"Courier New"'>2<span style='mso-spacerun:yes'> </span>CRC32<span
style='mso-spacerun:yes'> </span>1009560204<o:p></o:p></span></p>

<p class=MsoNoSpacing><span style='font-size:9.0pt;mso-bidi-font-size:11.0pt;
font-family:"Courier New"'>2<span style='mso-spacerun:yes'> </span>CRC32<span
style='mso-spacerun:yes'> </span>649440059<o:p></o:p></span></p>

<p class=MsoNoSpacing><span style='font-size:9.0pt;mso-bidi-font-size:11.0pt;
font-family:"Courier New"'>2<span style='mso-spacerun:yes'> </span>CRC32<span
style='mso-spacerun:yes'> </span>1449080003<o:p></o:p></span></p>

<p class=MsoNoSpacing><span style='font-size:9.0pt;mso-bidi-font-size:11.0pt;
font-family:"Courier New"'>2<span style='mso-spacerun:yes'> </span>CRC32<span
style='mso-spacerun:yes'> </span>-1989445225<o:p></o:p></span></p>

<p class=MsoNoSpacing><span style='font-size:9.0pt;mso-bidi-font-size:11.0pt;
font-family:"Courier New"'>3<span style='mso-spacerun:yes'> </span>&quot;Kaspersky
Lab&quot;<o:p></o:p></span></p>

<p class=MsoNoSpacing><span style='font-size:9.0pt;mso-bidi-font-size:11.0pt;
font-family:"Courier New"'>3<span style='mso-spacerun:yes'>
</span>&quot;Kaspersky Lab ZAO&quot;<o:p></o:p></span></p>

<p class=MsoNoSpacing><span class=GramE><span style='font-size:9.0pt;
mso-bidi-font-size:11.0pt;font-family:"Courier New"'>4<span
style='mso-spacerun:yes'> </span>.<span class=SpellE>pklav</span></span></span><span
style='font-size:9.0pt;mso-bidi-font-size:11.0pt;font-family:"Courier New"'><o:p></o:p></span></p>

<p class=MsoNoSpacing><span style='font-size:9.0pt;mso-bidi-font-size:11.0pt;
font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNoSpacing><span style='font-size:9.0pt;mso-bidi-font-size:11.0pt;
font-family:"Courier New"'># <span class=GramE>blacklist</span> <span
class=SpellE>Gmer</span><o:p></o:p></span></p>

<p class=MsoNoSpacing><span style='font-size:9.0pt;mso-bidi-font-size:11.0pt;
font-family:"Courier New"'>1<span style='mso-spacerun:yes'> </span>Gmer.exe<o:p></o:p></span></p>

<p class=MsoNoSpacing><span style='font-size:9.0pt;mso-bidi-font-size:11.0pt;
font-family:"Courier New"'>2<span style='mso-spacerun:yes'> </span>CRC32<span
style='mso-spacerun:yes'> </span>-1651801256<o:p></o:p></span></p>

<p class=MsoNoSpacing><span style='font-size:9.0pt;mso-bidi-font-size:11.0pt;
font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNoSpacing><span style='font-size:9.0pt;mso-bidi-font-size:11.0pt;
font-family:"Courier New"'># <span class=GramE>blacklist</span> <span
class=SpellE>aswMBR</span> (uses same engine as <span class=SpellE>Gmer</span>)<o:p></o:p></span></p>

<p class=MsoNoSpacing><span style='font-size:9.0pt;mso-bidi-font-size:11.0pt;
font-family:"Courier New"'>1<span style='mso-spacerun:yes'> </span>aswMBR.exe<o:p></o:p></span></p>

<p class=MsoNoSpacing><span style='font-size:9.0pt;mso-bidi-font-size:11.0pt;
font-family:"Courier New"'>2<span style='mso-spacerun:yes'> </span>CRC32<span
style='mso-spacerun:yes'> </span>2008367110<o:p></o:p></span></p>

<p class=MsoNoSpacing><span style='font-size:9.0pt;mso-bidi-font-size:11.0pt;
font-family:"Courier New"'>2<span style='mso-spacerun:yes'> </span>CRC32<span
style='mso-spacerun:yes'> </span>1770432001<o:p></o:p></span></p>

<p class=MsoNoSpacing><span style='font-size:9.0pt;mso-bidi-font-size:11.0pt;
font-family:"Courier New"'>2<span style='mso-spacerun:yes'> </span>CRC32<span
style='mso-spacerun:yes'> </span>1969924194<o:p></o:p></span></p>

<p class=MsoNoSpacing><span style='font-size:9.0pt;mso-bidi-font-size:11.0pt;
font-family:"Courier New"'>2<span style='mso-spacerun:yes'> </span>CRC32<span
style='mso-spacerun:yes'> </span>2103422372<o:p></o:p></span></p>

<p class=MsoNoSpacing><span style='font-size:9.0pt;mso-bidi-font-size:11.0pt;
font-family:"Courier New"'>2<span style='mso-spacerun:yes'> </span>CRC32<span
style='mso-spacerun:yes'> </span>-1560200948<o:p></o:p></span></p>

<p class=MsoNoSpacing><span style='font-size:9.0pt;mso-bidi-font-size:11.0pt;
font-family:"Courier New"'>2<span style='mso-spacerun:yes'> </span>CRC32<span
style='mso-spacerun:yes'> </span>-1770691826<o:p></o:p></span></p>

<p class=MsoNoSpacing><span style='font-size:9.0pt;mso-bidi-font-size:11.0pt;
font-family:"Courier New"'>3<span style='mso-spacerun:yes'>
</span>&quot;AVAST Software&quot;<o:p></o:p></span></p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing>This text file is compiled to a binary using a custom
parser and results in a 104 bytes binary file. The (binary) file format is very
simple: It has a small header followed by the 4 signature trees.</p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span class=SpellE><span
class=GramE><span style='font-size:9.5pt;font-family:Consolas;color:blue'>typedef</span></span></span><span
style='font-size:9.5pt;font-family:Consolas'> <span class=SpellE><span
style='color:blue'>struct</span></span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'>{<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-spacerun:yes'> </span>DWORD <span
class=SpellE>SizeOfHeader</span>;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-spacerun:yes'> </span>DWORD
CountSig1;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-spacerun:yes'> </span>DWORD
CountSig2;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-spacerun:yes'> </span>DWORD
CountSig3;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-spacerun:yes'> </span>DWORD
CountSig4;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'>} <span class=SpellE>SigHeader</span>;<o:p></o:p></span></p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<span style='font-size:11.0pt;line-height:115%;font-family:"Verdana","sans-serif";
mso-ascii-theme-font:minor-latin;mso-fareast-font-family:"Times New Roman";
mso-fareast-theme-font:minor-fareast;mso-hansi-theme-font:minor-latin;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US;mso-fareast-language:EN-US;mso-bidi-language:AR-SA'><br
clear=all style='mso-special-character:line-break;page-break-before:always'>
</span>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<h1><a name="_Toc318983983"></a><span class=SpellE><span style='mso-bookmark:
_Toc318983983'>Gmer</span></span><span style='mso-bookmark:_Toc318983983'></span></h1>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing><span class=SpellE>Gmer</span> deserves to be mentioned here
in a single chapter. It has a history with malware trying to blocking it. If
you want to download it, the website suggests already <span class=GramE>to use</span>
a button that generates a random file name, because some viruses used to block
(hard-coded) Gmer.exe [1]:</p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing><i style='mso-bidi-font-style:normal'><span
style='mso-tab-count:1'> </span>It's recommended to download randomly
named EXE (click button above) because some malware won't let gmer.exe launch.<o:p></o:p></i></p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing><span style='mso-no-proof:yes'>The developer was very
good with removing meta-data and identifiable information from the image 
though he missed one point, the icon. No matter what version, the icon remains
always the same, therefore making every Gmer executable identifiable.<o:p></o:p></span></p>

<p class=MsoNoSpacing><span style='mso-no-proof:yes'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNoSpacing><span style='mso-no-proof:yes'>The Gmer icon is shown
below, extracted using the program Resource Hacker [2].<o:p></o:p></span></p>

<p class=MsoNoSpacing><span style='mso-no-proof:yes'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNoSpacing><span style='mso-no-proof:yes'><v:shape id="Picture_x0020_27"
 o:spid="_x0000_i1029" type="#_x0000_t75" style='width:24pt;height:24pt;
 visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="Creating%20an%20Anti-AV%20scanner%20Article_files/image002.png"
  o:title=""/>
</v:shape><o:p></o:p></span></p>

<p class=MsoNoSpacing><span style='mso-no-proof:yes'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNoSpacing><span style='mso-no-proof:yes'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNoSpacing><span style='mso-no-proof:yes'><o:p>&nbsp;</o:p></span></p>

<span style='font-size:11.0pt;line-height:115%;font-family:"Verdana","sans-serif";
mso-ascii-theme-font:minor-latin;mso-fareast-font-family:"Times New Roman";
mso-fareast-theme-font:minor-fareast;mso-hansi-theme-font:minor-latin;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US;mso-fareast-language:EN-US;mso-bidi-language:AR-SA'><br
clear=all style='mso-special-character:line-break;page-break-before:always'>
</span>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<h1><a name="_Toc318983984"></a><span class=SpellE><span style='mso-bookmark:
_Toc318983984'>TDSSKiller</span></span><span style='mso-bookmark:_Toc318983984'></span></h1>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing>While <span class=SpellE>Gmer</span> is king in having
sparse identifiable information, <span class=SpellE>TDSSKiller</span> is the
opposite. The Black Scanner can be used to generate signatures (or at least
output that helps in generating signatures) and this is the result for <span
class=SpellE>TDSSKiller</span>:</p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing><span style='font-size:9.0pt;mso-bidi-font-size:11.0pt;
font-family:Consolas'>TDSSKiller.exe: Image Name CRC -984132845<o:p></o:p></span></p>

<p class=MsoNoSpacing><span style='font-size:9.0pt;mso-bidi-font-size:11.0pt;
font-family:Consolas'>TDSSKiller.exe: Section Name CRC -395631440<o:p></o:p></span></p>

<p class=MsoNoSpacing><span style='font-size:9.0pt;mso-bidi-font-size:11.0pt;
font-family:Consolas'>TDSSKiller.exe: Section Name CRC -1620306906<o:p></o:p></span></p>

<p class=MsoNoSpacing><span style='font-size:9.0pt;mso-bidi-font-size:11.0pt;
font-family:Consolas'>TDSSKiller.exe: Section Name CRC -421465104<o:p></o:p></span></p>

<p class=MsoNoSpacing><span style='font-size:9.0pt;mso-bidi-font-size:11.0pt;
font-family:Consolas'>TDSSKiller.exe: Section Name CRC 501016963<o:p></o:p></span></p>

<p class=MsoNoSpacing><span style='font-size:9.0pt;mso-bidi-font-size:11.0pt;
font-family:Consolas'>TDSSKiller.exe: Icon CRC 1561770547<o:p></o:p></span></p>

<p class=MsoNoSpacing style='tab-stops:244.5pt'><span style='font-size:9.0pt;
mso-bidi-font-size:11.0pt;font-family:Consolas'>TDSSKiller.exe: Icon CRC
1148540081<span style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNoSpacing><span style='font-size:9.0pt;mso-bidi-font-size:11.0pt;
font-family:Consolas'>TDSSKiller.exe: Icon CRC 616636565<o:p></o:p></span></p>

<p class=MsoNoSpacing><span style='font-size:9.0pt;mso-bidi-font-size:11.0pt;
font-family:Consolas'>TDSSKiller.exe: Icon CRC 1009560204<o:p></o:p></span></p>

<p class=MsoNoSpacing><span style='font-size:9.0pt;mso-bidi-font-size:11.0pt;
font-family:Consolas'>TDSSKiller.exe: Icon CRC 649440059<o:p></o:p></span></p>

<p class=MsoNoSpacing><span style='font-size:9.0pt;mso-bidi-font-size:11.0pt;
font-family:Consolas'>TDSSKiller.exe: Icon CRC 1449080003<o:p></o:p></span></p>

<p class=MsoNoSpacing><span style='font-size:9.0pt;mso-bidi-font-size:11.0pt;
font-family:Consolas'>TDSSKiller.exe: Icon CRC -1989445225<o:p></o:p></span></p>

<p class=MsoNoSpacing><span style='font-size:9.0pt;mso-bidi-font-size:11.0pt;
font-family:Consolas'>TDSSKiller.exe: Version Info -&gt; Company CRC 1627962736<o:p></o:p></span></p>

<p class=MsoNoSpacing><span style='font-size:9.0pt;mso-bidi-font-size:11.0pt;
font-family:Consolas'>TDSSKiller.exe: Version Info -&gt; Original File Name CRC
-984132845<o:p></o:p></span></p>

<p class=MsoNoSpacing><span style='font-size:9.0pt;mso-bidi-font-size:11.0pt;
font-family:Consolas'>TDSSKiller.exe: Certificate -&gt; O CRC 1231392781<o:p></o:p></span></p>

<p class=MsoNoSpacing><span style='font-size:9.0pt;mso-bidi-font-size:11.0pt;
font-family:Consolas'>TDSSKiller.exe: Certificate -&gt; CN CRC 1231392781<o:p></o:p></span></p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing>This output shows the CRCs (in decimal notation) of the
info. You can directly compare the CRCs of the icons with the sample signature
database in the chapter Signature Database. Prior to this generation
functionality of the scanner I had to manually extract the icon, and then
generate the CRC32 using 3<sup>rd</sup> party tools:</p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing><span style='mso-no-proof:yes'><v:shape id="Picture_x0020_6"
 o:spid="_x0000_i1028" type="#_x0000_t75" alt="Description: Description: cid:image001.png@01CCCCE7.E8DAD930"
 style='width:321.75pt;height:147.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="Creating%20an%20Anti-AV%20scanner%20Article_files/image006.png"
  o:title="image001.png@01CCCCE7"/>
</v:shape></span></p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing><span style='mso-no-proof:yes'><v:shape id="Picture_x0020_7"
 o:spid="_x0000_i1027" type="#_x0000_t75" alt="Description: Description: cid:image002.png@01CCCCE8.86C35910"
 style='width:378pt;height:246.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="Creating%20an%20Anti-AV%20scanner%20Article_files/image007.png"
  o:title="image002.png@01CCCCE8"/>
</v:shape></span></p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing>This acquired CRC32 can be added to the signature
database by adding a single line. The 2 means a CRC32 signature of a RT_ICON
resource:</p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing><span style='font-family:"Courier New"'>2 CRC32
1561770547<o:p></o:p></span></p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<span style='font-size:11.0pt;line-height:115%;font-family:"Verdana","sans-serif";
mso-ascii-theme-font:minor-latin;mso-fareast-font-family:"Times New Roman";
mso-fareast-theme-font:minor-fareast;mso-hansi-theme-font:minor-latin;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US;mso-fareast-language:EN-US;mso-bidi-language:AR-SA'><br
clear=all style='mso-special-character:line-break;page-break-before:always'>
</span>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<h1><a name="_Toc318983985">Preventing files from being executed</a></h1>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing>PE image files can be scanned in the <span class=SpellE>PsSetLoadImageNotifyRoutine</span>
driver callback function. That is, after the image is loaded into memory, but
before it is being executed. Previous blocking solutions in-the-wild <span
class=GramE>have</span> been implemented as:</p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing style='margin-left:.5in;text-indent:-.25in;mso-list:l2 level1 lfo4'><![if !supportLists]><span
style='mso-fareast-font-family:Verdana;mso-fareast-theme-font:minor-latin;
mso-bidi-font-family:Verdana;mso-bidi-theme-font:minor-latin'><span
style='mso-list:Ignore'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span></span><![endif]>Injecting an APC that calls <span class=SpellE>ExitProcess</span>()
 done by <span class=SpellE>ZeroAccess</span> [3]</p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing style='text-indent:35.4pt'><i style='mso-bidi-font-style:
normal'>When a typical security scanner tries to analyze the rootkit-created
svchost.exe file, the rootkit queues an initialized APC into the scanners own
process, then calls the <span class=SpellE>ExitProcess</span>() function 
essentially forcing the scanner to kill itself.</i></p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing style='margin-left:.5in;text-indent:-.25in;mso-list:l2 level1 lfo4'><![if !supportLists]><span
style='mso-fareast-font-family:Verdana;mso-fareast-theme-font:minor-latin;
mso-bidi-font-family:Verdana;mso-bidi-theme-font:minor-latin'><span
style='mso-list:Ignore'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span></span><![endif]>Patching the entry point with a ret instruction
 done by <span class=SpellE>BlackEnergy</span> [4]</p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing style='text-indent:35.4pt'><i style='mso-bidi-font-style:
normal'>Instead of <span class=SpellE>defence</span>, this malware attacks AV
by preventing AV processes from loading. It registers noti&#64257;cation
callbacks using functions such as <span class=SpellE>PsSetLoadImageNotifyRoutine</span>.<o:p></o:p></i></p>

<p class=MsoNoSpacing><i style='mso-bidi-font-style:normal'><o:p>&nbsp;</o:p></i></p>

<p class=MsoNoSpacing style='text-indent:35.4pt'><i style='mso-bidi-font-style:
normal'>When a process is loading, the malware gets a callback by the OS where
it &#64257;rst checks if the loading process is on its blacklist of known AV
processes. If it isnt, then the malware allows the process to load normally.
But if it is an AV process, the malware writes a return instruction (0xc3) at
the entry point in the memory of the process and then allows it to load. The AV
process typically terminates immediately due to this patch by the malware. This
technique was &#64257;rst reported to be used in the wild by <span
class=SpellE>Nuwar</span> back in 2007.<o:p></o:p></i></p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing>The simplest (and most practical) solution is to
overwrite the entry point with a return code. Below the entry point is patched
to return the infamous STATUS_TOO_MANY_SECRETS error code, from a <span
class=SpellE>bootkit</span> (which hashes the image name and compares it to a blacklist):</p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing><span style='mso-no-proof:yes'><v:shape id="Picture_x0020_8"
 o:spid="_x0000_i1026" type="#_x0000_t75" alt="Description: Description: cid:image001.png@01CCCC92.257492B0"
 style='width:482.25pt;height:84.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="Creating%20an%20Anti-AV%20scanner%20Article_files/image008.png"
  o:title="image001.png@01CCCC92"/>
</v:shape></span></p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing>This error code is also used by <span class=SpellE>ZeroAccess</span>
[3]:</p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing><span style='mso-no-proof:yes'><v:shape id="Picture_x0020_59"
 o:spid="_x0000_i1025" type="#_x0000_t75" style='width:304.5pt;height:36.75pt;
 visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="Creating%20an%20Anti-AV%20scanner%20Article_files/image009.jpg"
  o:title=""/>
</v:shape></span></p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing>And also by TDL4 [5]:</p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing><i style='mso-bidi-font-style:normal'><span
style='mso-tab-count:1'> </span>When a program or driver attempts to
open one of <span class=GramE>the<span style='mso-spacerun:yes'> </span>\</span>Device\<span
class=SpellE>HarddiskVolumeX</span><span style='mso-spacerun:yes'>
</span>devices, the rootkit will return error code 0xC0000156
(STATUS_TOO_MANY_SECRETS - the author had a sense of humor) to block
opening.<span style='mso-spacerun:yes'> </span><span class=GramE>Because most <span
class=SpellE>antirootkits</span> try to open this (for raw-disk scanning), most
of them will have issues.</span><o:p></o:p></i></p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing>Obviously also the TLS callbacks have to be patched, as
they are executed before the entry point.</p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing>A more funny solution would be to wipe the entire hard
disk (and maybe flash the boot firmware), to force the vendor to withdraw the
tool. Of course I am not supporting that, but installing Kaspersky on your
machine makes it to a brick already anyway.</p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<span style='font-size:11.0pt;line-height:115%;font-family:"Verdana","sans-serif";
mso-ascii-theme-font:minor-latin;mso-fareast-font-family:"Times New Roman";
mso-fareast-theme-font:minor-fareast;mso-hansi-theme-font:minor-latin;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US;mso-fareast-language:EN-US;mso-bidi-language:AR-SA'><br
clear=all style='mso-special-character:line-break;page-break-before:always'>
</span>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<h1><a name="_Toc318983986">Parsing Certificates</a></h1>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing>Even though there are Windows (user-mode) functions to
handle certificates (and extract information) they cannot be used here, because
one requirement of the scanner is to run within kernel mode.</p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing>Unfortunately, to make things even more complicated, the
certificate table has to be loaded explicitly into memory by the scanner. The
PE documentation (pecoff_v8.docx) says:</p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing><i style='mso-bidi-font-style:normal'><span
style='mso-tab-count:1'> </span>These certificates are not loaded into
memory as part of the image. As such, the first field of this entry, which is
normally an RVA, is a file pointer instead.<o:p></o:p></i></p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing>For the execution of user mode programs this makes
perfectly sense, because the certificate is not checked there. I verified that
the pointer remains a file pointer of the loaded image in memory (no cheating
by <span class=SpellE>Microsofts</span> PE loader). Also scanning the memory
for the certificate was without luck. In kernel mode, digital signatures of
images are verified by <span class=SpellE>ImgpValidateImageHash</span>, an
important function for <span class=SpellE>bootkits</span> (explained in The
Art of <span class=SpellE>Bootkit</span> Development).</p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing>In fact the certificate is stored immediately after the
Certificate Table in PCKS7 DER encoded format. Microsoft calls it
Authenticode. <span class=SpellE>OpenSSL</span> supports that format, you can
launch following command on the dumped raw certificate:</p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing><span style='font-size:10.0pt;mso-bidi-font-size:11.0pt;
font-family:"Courier New"'>openssl.exe pkcs7 -inform DER -text -<span
class=SpellE>print_certs</span> -in rawcert.pkcs7<o:p></o:p></span></p>

<p class=MsoNoSpacing><span style='font-size:10.0pt;mso-bidi-font-size:11.0pt;
font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNoSpacing><span style='font-size:10.0pt;mso-bidi-font-size:11.0pt;
font-family:"Courier New"'>Certificate:<o:p></o:p></span></p>

<p class=MsoNoSpacing><span style='font-size:10.0pt;mso-bidi-font-size:11.0pt;
font-family:"Courier New"'><span style='mso-spacerun:yes'> </span>Data:<o:p></o:p></span></p>

<p class=MsoNoSpacing><span style='font-size:10.0pt;mso-bidi-font-size:11.0pt;
font-family:"Courier New"'><span style='mso-spacerun:yes'>
</span>Version: 3 (0x2)<o:p></o:p></span></p>

<p class=MsoNoSpacing><span style='font-size:10.0pt;mso-bidi-font-size:11.0pt;
font-family:"Courier New"'><span style='mso-spacerun:yes'> </span>Serial
Number:<o:p></o:p></span></p>

<p class=MsoNoSpacing><span style='font-size:10.0pt;mso-bidi-font-size:11.0pt;
font-family:"Courier New"'><span style='mso-spacerun:yes'>
</span>11:a3:0b<span class=GramE>:cf:b2:e8:2a:d7:1f:54:1d:11:27:ab:d1:f6</span><o:p></o:p></span></p>

<p class=MsoNoSpacing><span style='font-size:10.0pt;mso-bidi-font-size:11.0pt;
font-family:"Courier New"'><span style='mso-spacerun:yes'>
</span>Signature Algorithm: sha1WithRSAEncryption<o:p></o:p></span></p>

<p class=MsoNoSpacing><span style='font-size:10.0pt;mso-bidi-font-size:11.0pt;
font-family:"Courier New"'><span style='mso-spacerun:yes'>
</span>Issuer: C=US, O=VeriSign, Inc., OU=VeriSign Trust Network, OU=Terms of
use at https://www.verisign.com/rpa (c<span class=GramE>)10</span>, CN=VeriSign
Class 3 Code Signing 2010 CA<o:p></o:p></span></p>

<p class=MsoNoSpacing><span style='font-size:10.0pt;mso-bidi-font-size:11.0pt;
font-family:"Courier New"'><span style='mso-spacerun:yes'>
</span>Validity<o:p></o:p></span></p>

<p class=MsoNoSpacing><span style='font-size:10.0pt;mso-bidi-font-size:11.0pt;
font-family:"Courier New"'><span style='mso-spacerun:yes'>
</span>Not Before: Feb 21 00:00:00 2011 GMT<o:p></o:p></span></p>

<p class=MsoNoSpacing><span style='font-size:10.0pt;mso-bidi-font-size:11.0pt;
font-family:"Courier New"'><span style='mso-spacerun:yes'>
</span>Not <span class=GramE>After :</span> Mar<span style='mso-spacerun:yes'>
</span>7 23:59:59 2012 GMT<o:p></o:p></span></p>

<p class=MsoNoSpacing><span style='font-size:10.0pt;mso-bidi-font-size:11.0pt;
font-family:"Courier New"'><span style='mso-spacerun:yes'>
</span>Subject: C=RU, ST=Moscow, L=Moscow, O=<span style='background:yellow;
mso-highlight:yellow'>Kaspersky Lab</span>, OU=Digital ID Class 3 - Microsoft
Software Validation v2, OU=Technical <span class=SpellE>dept</span>, CN=<span
style='background:yellow;mso-highlight:yellow'>Kaspersky Lab</span><o:p></o:p></span></p>

<p class=MsoNoSpacing><span style='font-size:10.0pt;mso-bidi-font-size:11.0pt;
font-family:"Courier New"'><span style='mso-spacerun:yes'>
</span>Subject Public Key Info:<o:p></o:p></span></p>

<p class=MsoNoSpacing><span style='font-size:10.0pt;mso-bidi-font-size:11.0pt;
font-family:"Courier New"'><span style='mso-spacerun:yes'>
</span>Public Key Algorithm: <span class=SpellE>rsaEncryption</span><o:p></o:p></span></p>

<p class=MsoNoSpacing><span style='font-size:10.0pt;mso-bidi-font-size:11.0pt;
font-family:"Courier New"'><span style='mso-spacerun:yes'>
</span>RSA Public Key: (2048 bit)<o:p></o:p></span></p>

<p class=MsoNoSpacing><span style='font-size:10.0pt;mso-bidi-font-size:11.0pt;
font-family:"Courier New"'><span style='mso-spacerun:yes'>
</span>Modulus (2048 bit):<o:p></o:p></span></p>

<p class=MsoNoSpacing><span style='font-size:10.0pt;mso-bidi-font-size:11.0pt;
font-family:"Courier New"'><span style='mso-spacerun:yes'>
</span>00<span class=GramE>:bd:95:60:5a:15:bb:1d:de:23:a6:3b:ab:d2:73</span>:<o:p></o:p></span></p>

<p class=MsoNoSpacing><span style='font-size:10.0pt;mso-bidi-font-size:11.0pt;
font-family:"Courier New"'><span style='mso-spacerun:yes'>
</span></span><span lang=DE-AT style='font-size:10.0pt;mso-bidi-font-size:11.0pt;
font-family:"Courier New";mso-ansi-language:DE-AT'>ea:44:38:1e:ee:29:91:7f:f3:22:b6:39:ce:40:1f:<o:p></o:p></span></p>

<p class=MsoNoSpacing><span lang=DE-AT style='font-size:10.0pt;mso-bidi-font-size:
11.0pt;font-family:"Courier New";mso-ansi-language:DE-AT'><span
style='mso-spacerun:yes'> </span>43:45:24:7d:b4:b0:df:6e:bf:5d:3a:19:f9:c8:e1:<o:p></o:p></span></p>

<p class=MsoNoSpacing><span style='font-size:10.0pt;mso-bidi-font-size:11.0pt;
font-family:"Courier New"'>...<o:p></o:p></span></p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing>One interesting thing about Authenticode is that
Microsoft still allows the use of MD5 hashes, whereof collisions can be easily
generated. SHA-1 is used by <span class=SpellE>Microsofts</span> code signing
tool by default though. [6] [7]</p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing>The <span class=SpellE>OpenSSL</span> library, however,
turns out to be unusable in the scanner. It is bloated up, (the official
distribution) requires <span class=SpellE>MinGW</span>/Gnu <span class=SpellE>LibGwC</span>
on Windows, contains as good as no comments in its source (badly documented,
the spare html website does not help there either) is unreadable and the PKCS7
code is not abstracted from things like the data input at all. I would not call
this interoperability.</p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing>However, there is a very good lightweight ASN.1 dumping
code available from Peter <span class=SpellE>Gutmann</span>. PKCS7 uses ASN.1
representation. The interesting fields there are the ones with the object
identifier 2 5 4 10 = Organization Name (O) and 2 5 4 3 = Common Name (CN).</p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<span style='font-size:11.0pt;line-height:115%;font-family:"Verdana","sans-serif";
mso-ascii-theme-font:minor-latin;mso-fareast-font-family:"Times New Roman";
mso-fareast-theme-font:minor-fareast;mso-hansi-theme-font:minor-latin;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US;mso-fareast-language:EN-US;mso-bidi-language:AR-SA'><br
clear=all style='mso-special-character:line-break;page-break-before:always'>
</span>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<h1><a name="_Toc318983987">AV Zoo</a></h1>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing>Opening an AV zoo is important for the signature
generation to stay up to date. Like AVs download the virus samples directly
from the source (from the bad guys C&amp;Cs), the AVs (or remover tools) can be
downloaded automatically.</p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing><span class=SpellE>TDSSKiller</span> is a good example
here, on every run it checks if there is an updated version on the Kaspersky
server. For that reason it downloads an xml file:</p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing><span style='font-family:"Courier New"'>4<span
style='mso-spacerun:yes'> </span>0.064434<span style='mso-spacerun:yes'>
</span>10.0.0.2<span style='mso-spacerun:yes'> </span>195.27.181.39<span
style='mso-spacerun:yes'> </span><span class=GramE>HTTP<span
style='mso-spacerun:yes'> </span>GET</span> /downloads/<span class=SpellE>utils</span>/tdsskiller.xml
HTTP/1.1<o:p></o:p></span></p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing>That file can be downloaded directly from <a
href="http://195.27.181.39/downloads/utils/tdsskiller.xml">http://195.27.181.39/downloads/utils/tdsskiller.xml</a>:</p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing><span style='font-size:10.0pt;mso-bidi-font-size:11.0pt;
font-family:"Courier New"'>&lt;<span class=SpellE><span class=GramE>tdsskiller</span></span>&gt;<o:p></o:p></span></p>

<p class=MsoNoSpacing><span style='font-size:10.0pt;mso-bidi-font-size:11.0pt;
font-family:"Courier New"'><span style='mso-spacerun:yes'> </span>&lt;<span
class=GramE>release</span>&gt;<o:p></o:p></span></p>

<p class=MsoNoSpacing><span style='font-size:10.0pt;mso-bidi-font-size:11.0pt;
font-family:"Courier New"'><span style='mso-spacerun:yes'>
</span>&lt;version&gt;2.7.0.0&lt;/version&gt;<o:p></o:p></span></p>

<p class=MsoNoSpacing><span style='font-size:10.0pt;mso-bidi-font-size:11.0pt;
font-family:"Courier New"'><span style='mso-spacerun:yes'>
</span>&lt;downloadzip&gt;http://support.kaspersky.com/downloads/utils/tdsskiller.zip&lt;/downloadzip&gt;<o:p></o:p></span></p>

<p class=MsoNoSpacing><span style='font-size:10.0pt;mso-bidi-font-size:11.0pt;
font-family:"Courier New"'><span style='mso-spacerun:yes'>
</span>&lt;description&gt;http://support.kaspersky.com/faq/?qid=208283363&lt;/description&gt;<o:p></o:p></span></p>

<p class=MsoNoSpacing><span style='font-size:10.0pt;mso-bidi-font-size:11.0pt;
font-family:"Courier New"'><span style='mso-spacerun:yes'>
</span>&lt;/release&gt;<o:p></o:p></span></p>

<p class=MsoNoSpacing><span style='font-size:10.0pt;mso-bidi-font-size:11.0pt;
font-family:"Courier New"'>&lt;/<span class=SpellE>tdsskiller</span>&gt;<o:p></o:p></span></p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing>This simple xml format is ideal for automating the
download process, and automatically adding the latest <span class=SpellE>TDSSKiller</span>
version to the zoo.</p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing>Ideally, an automated system checks every half hour for a
new version and automatically <span style='mso-ascii-font-family:Verdana;
mso-ascii-theme-font:major-latin;mso-hansi-font-family:Verdana;mso-hansi-theme-font:
major-latin'>generates a new signature in case it is not detected. For a
botnet, this means the bad guys could always stay ahead of anti-viruses. The
process:<o:p></o:p></span></p>

<p class=MsoNoSpacing><span style='mso-ascii-font-family:Verdana;mso-ascii-theme-font:
major-latin;mso-hansi-font-family:Verdana;mso-hansi-theme-font:major-latin'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNoSpacing style='margin-left:.5in;text-indent:-.25in;mso-list:l0 level1 lfo6'><![if !supportLists]><span
style='mso-ascii-font-family:Verdana;mso-ascii-theme-font:major-latin;
mso-fareast-font-family:Verdana;mso-fareast-theme-font:major-latin;mso-hansi-font-family:
Verdana;mso-hansi-theme-font:major-latin;mso-bidi-font-family:Verdana;
mso-bidi-theme-font:major-latin'><span style='mso-list:Ignore'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp; </span></span></span><![endif]><span
class=SpellE><span style='mso-ascii-font-family:Verdana;mso-ascii-theme-font:
major-latin;mso-hansi-font-family:Verdana;mso-hansi-theme-font:major-latin;
mso-bidi-font-family:"Courier New"'>Dowload</span></span><span
style='mso-ascii-font-family:Verdana;mso-ascii-theme-font:major-latin;
mso-hansi-font-family:Verdana;mso-hansi-theme-font:major-latin;mso-bidi-font-family:
"Courier New"'> anti-virus executable<o:p></o:p></span></p>

<p class=MsoNoSpacing style='margin-left:.5in;text-indent:-.25in;mso-list:l0 level1 lfo6'><![if !supportLists]><span
style='mso-ascii-font-family:Verdana;mso-ascii-theme-font:major-latin;
mso-fareast-font-family:Verdana;mso-fareast-theme-font:major-latin;mso-hansi-font-family:
Verdana;mso-hansi-theme-font:major-latin;mso-bidi-font-family:Verdana;
mso-bidi-theme-font:major-latin'><span style='mso-list:Ignore'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp; </span></span></span><![endif]><span
style='mso-ascii-font-family:Verdana;mso-ascii-theme-font:major-latin;
mso-hansi-font-family:Verdana;mso-hansi-theme-font:major-latin;mso-bidi-font-family:
"Courier New"'>Check if it is a new file (SHA-1 hash), if not -&gt; exit<o:p></o:p></span></p>

<p class=MsoNoSpacing style='margin-left:.5in;text-indent:-.25in;mso-list:l0 level1 lfo6'><![if !supportLists]><span
style='mso-ascii-font-family:Verdana;mso-ascii-theme-font:major-latin;
mso-fareast-font-family:Verdana;mso-fareast-theme-font:major-latin;mso-hansi-font-family:
Verdana;mso-hansi-theme-font:major-latin;mso-bidi-font-family:Verdana;
mso-bidi-theme-font:major-latin'><span style='mso-list:Ignore'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp; </span></span></span><![endif]><span
style='mso-ascii-font-family:Verdana;mso-ascii-theme-font:major-latin;
mso-hansi-font-family:Verdana;mso-hansi-theme-font:major-latin;mso-bidi-font-family:
"Courier New"'>Add it to the AV database (zoo)<o:p></o:p></span></p>

<p class=MsoNoSpacing style='margin-left:.5in;text-indent:-.25in;mso-list:l0 level1 lfo6'><![if !supportLists]><span
style='mso-ascii-font-family:Verdana;mso-ascii-theme-font:major-latin;
mso-fareast-font-family:Verdana;mso-fareast-theme-font:major-latin;mso-hansi-font-family:
Verdana;mso-hansi-theme-font:major-latin;mso-bidi-font-family:Verdana;
mso-bidi-theme-font:major-latin'><span style='mso-list:Ignore'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp; </span></span></span><![endif]><span
style='mso-ascii-font-family:Verdana;mso-ascii-theme-font:major-latin;
mso-hansi-font-family:Verdana;mso-hansi-theme-font:major-latin;mso-bidi-font-family:
"Courier New"'>Check if it is detected by current signatures, if so -&gt; exit<o:p></o:p></span></p>

<p class=MsoNoSpacing style='margin-left:.5in;text-indent:-.25in;mso-list:l0 level1 lfo6'><![if !supportLists]><span
style='mso-ascii-font-family:Verdana;mso-ascii-theme-font:major-latin;
mso-fareast-font-family:Verdana;mso-fareast-theme-font:major-latin;mso-hansi-font-family:
Verdana;mso-hansi-theme-font:major-latin;mso-bidi-font-family:Verdana;
mso-bidi-theme-font:major-latin'><span style='mso-list:Ignore'>5.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp; </span></span></span><![endif]><span
style='mso-ascii-font-family:Verdana;mso-ascii-theme-font:major-latin;
mso-hansi-font-family:Verdana;mso-hansi-theme-font:major-latin;mso-bidi-font-family:
"Courier New"'>Generate a new signature and alarm the developer<o:p></o:p></span></p>

<p class=MsoNoSpacing style='margin-left:1.0in;text-indent:-.25in;mso-list:
l0 level2 lfo6'><![if !supportLists]><span style='mso-ascii-font-family:Verdana;
mso-ascii-theme-font:major-latin;mso-fareast-font-family:Verdana;mso-fareast-theme-font:
major-latin;mso-hansi-font-family:Verdana;mso-hansi-theme-font:major-latin;
mso-bidi-font-family:Verdana;mso-bidi-theme-font:major-latin'><span
style='mso-list:Ignore'>a.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='mso-ascii-font-family:Verdana;
mso-ascii-theme-font:major-latin;mso-hansi-font-family:Verdana;mso-hansi-theme-font:
major-latin;mso-bidi-font-family:"Courier New"'>Compare the signature over
legitimate files<o:p></o:p></span></p>

<p class=MsoNoSpacing style='margin-left:1.0in;text-indent:-.25in;mso-list:
l0 level2 lfo6'><![if !supportLists]><span style='mso-ascii-font-family:Verdana;
mso-ascii-theme-font:major-latin;mso-fareast-font-family:Verdana;mso-fareast-theme-font:
major-latin;mso-hansi-font-family:Verdana;mso-hansi-theme-font:major-latin;
mso-bidi-font-family:Verdana;mso-bidi-theme-font:major-latin'><span
style='mso-list:Ignore'>b.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='mso-ascii-font-family:Verdana;
mso-ascii-theme-font:major-latin;mso-hansi-font-family:Verdana;mso-hansi-theme-font:
major-latin;mso-bidi-font-family:"Courier New"'>Generate a new signature
database<o:p></o:p></span></p>

<p class=MsoNoSpacing style='margin-left:.5in;text-indent:-.25in;mso-list:l0 level1 lfo6'><![if !supportLists]><span
style='mso-ascii-font-family:Verdana;mso-ascii-theme-font:major-latin;
mso-fareast-font-family:Verdana;mso-fareast-theme-font:major-latin;mso-hansi-font-family:
Verdana;mso-hansi-theme-font:major-latin;mso-bidi-font-family:Verdana;
mso-bidi-theme-font:major-latin'><span style='mso-list:Ignore'>6.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp; </span></span></span><![endif]><span
style='mso-ascii-font-family:Verdana;mso-ascii-theme-font:major-latin;
mso-hansi-font-family:Verdana;mso-hansi-theme-font:major-latin;mso-bidi-font-family:
"Courier New"'>Deploy the new signature database to the botnet<o:p></o:p></span></p>

<p class=MsoNoSpacing><span style='mso-ascii-font-family:Verdana;mso-ascii-theme-font:
major-latin;mso-hansi-font-family:Verdana;mso-hansi-theme-font:major-latin'><o:p>&nbsp;</o:p></span></p>

<span style='font-size:11.0pt;line-height:115%;font-family:"Verdana","sans-serif";
mso-ascii-theme-font:major-latin;mso-fareast-font-family:"Times New Roman";
mso-fareast-theme-font:minor-fareast;mso-hansi-theme-font:major-latin;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:EN-US;mso-fareast-language:EN-US;mso-bidi-language:AR-SA'><br
clear=all style='mso-special-character:line-break;page-break-before:always'>
</span>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<h1><a name="_Toc318983988">Behind the scenes  technical implementation</a></h1>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing>The project is split into the scanner and the actual
scanner engine. The engine is coded in C/C++ and uses a structure to save its internal
state:</p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span class=SpellE><span
class=GramE><span style='font-size:9.5pt;font-family:Consolas;color:blue'>struct</span></span></span><span
style='font-size:9.5pt;font-family:Consolas'> Scanner<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'>{<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-spacerun:yes'> </span><span
style='color:green'>// Input File (all parameters are required)</span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-spacerun:yes'> </span><span
class=GramE><span style='color:blue'>char</span></span> * <span class=SpellE>ImageName</span>;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-spacerun:yes'> </span><span
class=SpellE><span style='color:blue'>wchar_t</span></span> * <span
class=SpellE>FullFilePath</span>;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-spacerun:yes'> </span><span
class=GramE><span style='color:blue'>void</span></span> * <span class=SpellE>ImageBase</span>;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-spacerun:yes'> </span><span
style='color:green'>// Scanning Options</span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-spacerun:yes'> </span>BOOL <span
class=SpellE>StopOnFirstFound</span>;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-spacerun:yes'> </span>BOOL <span
class=SpellE>SignatureGenerationMode</span>;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-spacerun:yes'> </span><span
class=GramE><span style='color:blue'>void</span></span> (* Callback)(<span
class=SpellE><span style='color:blue'>const</span></span> Scanner * Instance);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-spacerun:yes'> </span><span
style='color:green'>// Results</span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-spacerun:yes'> </span><span
class=GramE><span style='color:blue'>unsigned</span></span> <span class=SpellE>SignaturesFound</span>;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-spacerun:yes'> </span><span
class=GramE><span style='color:blue'>unsigned</span></span> <span class=SpellE>LastSigType</span>;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-spacerun:yes'> </span>DWORD <span
class=SpellE>LastBadCRC</span>;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-spacerun:yes'> </span><span
style='color:green'>// Internal Data</span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-spacerun:yes'>
</span>PIMAGE_NT_HEADERS <span class=SpellE>NtHeader</span>;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-spacerun:yes'> </span>DWORD <span
class=SpellE>ImageSize</span>;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'>};<o:p></o:p></span></p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing>The callback is called on every found infection. The
scanner engine was developed to check files that are loaded into memory (on the
image notification callback). To check files on hard disk, the scanner uses <span
class=SpellE>LoadLibraryEx</span> with the DONT_RESOLVE_DLL_REFERENCES flag
(that prevents the entry point of being called).</p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing>The most complicated code part was the resource parsing.
Someone at Microsoft should be fired for making these <span class=GramE>unwell</span>
defined flying around structures.</p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing>The core function is <span class=SpellE>ScanCRCInDatabase</span>
which looks up a generated CRC in the tree corresponding to the specific
signature type. If it finds it, it will invoke the callback.</p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing>The source is published under the European Union Public <span
class=SpellE>Licence</span>.</p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

</div>

<span style='font-size:11.0pt;font-family:"Verdana","sans-serif";mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:"Times New Roman";mso-fareast-theme-font:
minor-fareast;mso-hansi-theme-font:minor-latin;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US;mso-fareast-language:
EN-US;mso-bidi-language:AR-SA'><br clear=all style='page-break-before:always;
mso-break-type:section-break'>
</span>

<div class=WordSection3>

<h1 style='margin-top:0in'><a name="_Toc318983989">Conclusion</a></h1>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing>What I have shown here is the reverse operation of an anti-virus,
relying on meta-data and the fact that AV files are easy identifiable.
Obviously this is only of advantage if the virus is <i style='mso-bidi-font-style:
normal'>already installed</i>. What I have described is a way to protect from
anti-viruses, not how to bypass them.</p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing>At the end of the day virus developers always have a
small advantage though. They can use services like scan4you or KIMS to check if
they are being detected and doing appropriate changes. AV vendors, however,
cannot simply change their file name, product name etc.</p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing><span class=SpellE>Conficker</span> is a famous example
of a virus that was blocking AVs as hell. With the result however, that is was
simple enough visiting a website to check if someones infected (<span
class=SpellE>Conficker</span> blocks AV websites so embedded pictures linked to
them would not show up).</p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing><i style='mso-bidi-font-style:normal'><span lang=DE-AT
style='mso-ansi-language:DE-AT'>Peter Kleissner<o:p></o:p></span></i></p>

<p class=MsoNoSpacing><span lang=DE-AT style='mso-ansi-language:DE-AT'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNoSpacing><span lang=DE-AT style='mso-ansi-language:DE-AT'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNoSpacing><span lang=DE-AT style='mso-ansi-language:DE-AT'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNoSpacing><span lang=DE-AT style='mso-ansi-language:DE-AT'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNoSpacing><span lang=DE-AT style='mso-ansi-language:DE-AT'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNoSpacing><span lang=DE-AT style='mso-ansi-language:DE-AT'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNoSpacing><span lang=DE-AT style='mso-ansi-language:DE-AT'><o:p>&nbsp;</o:p></span></p>

<span lang=DE-AT style='font-size:11.0pt;line-height:115%;font-family:"Verdana","sans-serif";
mso-ascii-theme-font:minor-latin;mso-fareast-font-family:"Times New Roman";
mso-fareast-theme-font:minor-fareast;mso-hansi-theme-font:minor-latin;
mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:minor-bidi;
mso-ansi-language:DE-AT;mso-fareast-language:EN-US;mso-bidi-language:AR-SA'><br
clear=all style='mso-special-character:line-break;page-break-before:always'>
</span>

<p class=MsoNormal><span lang=DE-AT style='mso-ansi-language:DE-AT'><o:p>&nbsp;</o:p></span></p>

<h1><a name="_Toc318983990"><span lang=DE-AT style='mso-ansi-language:DE-AT'>References</span></a><span
lang=DE-AT style='mso-ansi-language:DE-AT'><o:p></o:p></span></h1>

<p class=MsoNoSpacing><span lang=DE-AT style='mso-ansi-language:DE-AT'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNoSpacing><span lang=DE-AT style='mso-ansi-language:DE-AT'>[1]<span
style='mso-tab-count:1'> </span>Gmer<o:p></o:p></span></p>

<p class=MsoNoSpacing><a href="http://www.gmer.net/"><span lang=DE-AT
style='mso-ansi-language:DE-AT'>http://www.gmer.net/</span></a><span
lang=DE-AT style='mso-ansi-language:DE-AT'><o:p></o:p></span></p>

<p class=MsoNoSpacing><span lang=DE-AT style='mso-ansi-language:DE-AT'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNoSpacing>[2]<span style='mso-tab-count:1'> </span>Resource
Hacker</p>

<p class=MsoNoSpacing><a href="http://www.angusj.com/resourcehacker/">http://www.angusj.com/resourcehacker/</a></p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing>[3]<span style='mso-tab-count:1'> </span><span
class=SpellE>Webroot</span>: <span class=SpellE>ZeroAccess</span> Rootkit
Guards Itself with a Tripwire</p>

<p class=MsoNoSpacing><a
href="http://blog.webroot.com/2011/07/08/zeroaccess-rootkit-guards-itself-with-a-tripwire/">http://blog.webroot.com/2011/07/08/zeroaccess-rootkit-guards-itself-with-a-tripwire/</a></p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing>[4]<span style='mso-tab-count:1'> </span>McAfee: Predicting
the future of stealth attacks</p>

<p class=MsoNoSpacing><a
href="http://www.mcafee.com/us/resources/reports/rp-predicting-stealth-attacks.pdf">http://www.mcafee.com/us/resources/reports/rp-predicting-stealth-attacks.pdf</a></p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing>[5]<span style='mso-tab-count:1'> </span>Forum entry
at <span class=SpellE>Sysinternals</span> Interesting new malware</p>

<p class=MsoNoSpacing><a
href="http://forum.sysinternals.com/interesting-new-malware_topic15413.html">http://forum.sysinternals.com/interesting-new-malware_topic15413.html</a></p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing>[6]<span style='mso-tab-count:1'> </span>Playing With
Authenticode and MD5 Collisions</p>

<p class=MsoNoSpacing><a
href="http://blog.didierstevens.com/2009/01/17/playing-with-authenticode-and-md5-collisions/">http://blog.didierstevens.com/2009/01/17/playing-with-authenticode-and-md5-collisions/</a></p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing>[7]<span style='mso-tab-count:1'> </span>MD5
Collision Demo</p>

<p class=MsoNoSpacing><a href="http://www.mscs.dal.ca/~selinger/md5collision/">http://www.mscs.dal.ca/~selinger/md5collision/</a></p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

<p class=MsoNoSpacing>[8]<span style='mso-tab-count:1'> </span>Format of a
Signed File and ASN.1 dumping code</p>

<p class=MsoNoSpacing><a
href="http://www.cs.auckland.ac.nz/~pgut001/pubs/authenticode.txt">http://www.cs.auckland.ac.nz/~pgut001/pubs/authenticode.txt</a></p>

<p class=MsoNoSpacing><a href="http://www.cs.auckland.ac.nz/~pgut001/dumpasn1.c">http://www.cs.auckland.ac.nz/~pgut001/dumpasn1.c</a></p>

<p class=MsoNoSpacing><o:p>&nbsp;</o:p></p>

</div>

</body>

</html>
